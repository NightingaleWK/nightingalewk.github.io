{
    "version": "https://jsonfeed.org/version/1",
    "title": "雪漫城的风宅 • All posts by \"github\" tag",
    "description": "この世界は好都合に未完成 だから知りたいんだ —— チ。-地球の運動について-",
    "home_page_url": "https://nightingalewk.cn",
    "items": [
        {
            "id": "https://nightingalewk.cn/2026/01/24/84.%20Laravel%20Sail%20%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2%E4%B8%80%E6%8A%8A%E8%BF%87%EF%BC%88Git%20%E5%90%8C%E6%AD%A5%E4%B8%8E%E5%A4%9A%E6%9C%BA%E5%BC%80%E5%8F%91%E7%AF%87%EF%BC%89/",
            "url": "https://nightingalewk.cn/2026/01/24/84.%20Laravel%20Sail%20%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2%E4%B8%80%E6%8A%8A%E8%BF%87%EF%BC%88Git%20%E5%90%8C%E6%AD%A5%E4%B8%8E%E5%A4%9A%E6%9C%BA%E5%BC%80%E5%8F%91%E7%AF%87%EF%BC%89/",
            "title": "Laravel Sail 开发环境部署一把过（Git 同步与多机开发篇）",
            "date_published": "2026-01-24T02:00:00.000Z",
            "content_html": "<h2 id=\"协同工作流概述\"><a href=\"#协同工作流概述\" class=\"headerlink\" title=\"协同工作流概述\"></a>协同工作流概述</h2><p>在多设备（如公司工作站与家用 PC）间同步 Laravel Sail 项目时，核心挑战在于<strong>依赖的引导与恢复</strong>。<br>由于 <code>sail</code> 命令行脚本位于 <code>/vendor/bin</code> 目录下，而 <code>/vendor</code> 目录通常被 Git 忽略。这导致在新设备拉取代码后，因缺少 <code>vendor</code> 目录而无法直接调用 <code>sail</code> 命令启动环境，进而无法安装依赖——这是一个典型的死锁问题。</p>\n<p>本文将介绍标准化的多机协同方案，通过 Docker 临时容器完成依赖的 <strong>初始化引导 （Bootstrapping）</strong>。</p>\n<hr>\n<h2 id=\"1-源代码提交-（Source-Control）\"><a href=\"#1-源代码提交-（Source-Control）\" class=\"headerlink\" title=\"1. 源代码提交 （Source Control）\"></a>1. 源代码提交 （Source Control）</h2><p>在首台设备（如初始化项目的机器）上，需确保 Git 忽略规则符合标准。Laravel 默认的 <code>.gitignore</code> 已包含 <code>/vendor</code> 与 <code>.env</code>，请遵循此规范，<strong>切勿</strong>将依赖包或敏感配置提交至版本控制系统。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 标准 Git 初始化流程</span></span><br><span class=\"line\">git init</span><br><span class=\"line\">git checkout -b main</span><br><span class=\"line\">git add .</span><br><span class=\"line\">git commit -m <span class=\"string\">&quot;feat: project init&quot;</span></span><br><span class=\"line\">git remote add origin &lt;repository_url&gt;</span><br><span class=\"line\">git push -u origin main</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"2-新环境拉取与依赖引导\"><a href=\"#2-新环境拉取与依赖引导\" class=\"headerlink\" title=\"2. 新环境拉取与依赖引导\"></a>2. 新环境拉取与依赖引导</h2><p>在第二台设备上，确保已部署好 WSL2 与 Docker Desktop 环境。</p>\n<h3 id=\"2-1-克隆代码\"><a href=\"#2-1-克隆代码\" class=\"headerlink\" title=\"2.1 克隆代码\"></a>2.1 克隆代码</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">mkdir</span> -p ~/code &amp;&amp; <span class=\"built_in\">cd</span> ~/code</span><br><span class=\"line\">git <span class=\"built_in\">clone</span> &lt;repository_url&gt; project-name</span><br><span class=\"line\"><span class=\"built_in\">cd</span> project-name</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-2-依赖引导-（Dependency-Bootstrapping）\"><a href=\"#2-2-依赖引导-（Dependency-Bootstrapping）\" class=\"headerlink\" title=\"2.2 依赖引导 （Dependency Bootstrapping）\"></a>2.2 依赖引导 （Dependency Bootstrapping）</h3><p>此时无法直接运行 <code>sail up</code>。我们需要通过 Docker 运行一个一次性的 PHP 容器来执行 <code>composer install</code>。</p>\n<p>执行以下指令（Laravel 官方推荐方案）：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run --<span class=\"built_in\">rm</span> \\</span><br><span class=\"line\">    -u <span class=\"string\">&quot;<span class=\"subst\">$(id -u)</span>:<span class=\"subst\">$(id -g)</span>&quot;</span> \\</span><br><span class=\"line\">    -v <span class=\"string\">&quot;<span class=\"subst\">$(pwd)</span>:/var/www/html&quot;</span> \\</span><br><span class=\"line\">    -w /var/www/html \\</span><br><span class=\"line\">    laravelsail/php82-composer:latest \\</span><br><span class=\"line\">    composer install --ignore-platform-reqs</span><br></pre></td></tr></table></figure>\n\n<p><strong>指令解析</strong>：</p>\n<ul>\n<li><code>--rm</code>: 容器执行完毕后自动删除，不残留垃圾。</li>\n<li><code>-u &quot;$(id -u):$(id -g)&quot;</code>: 使用当前宿主机用户 ID 运行容器内进程，<strong>确保生成的 vendor 文件权限正确</strong>（避免 root 权限问题）。</li>\n<li><code>-v &quot;$(pwd):/var/www/html&quot;</code>: 将当前项目目录挂载至容器。</li>\n<li><code>laravelsail/php82-composer</code>: 使用包含 PHP 8.2 和 Composer 的专用镜像。</li>\n</ul>\n<p>执行完毕后，宿主机目录下将生成标准的 <code>vendor</code> 目录，此时 <code>sail</code> 脚本已就位。</p>\n<hr>\n<h2 id=\"3-环境配置与启动\"><a href=\"#3-环境配置与启动\" class=\"headerlink\" title=\"3. 环境配置与启动\"></a>3. 环境配置与启动</h2><h3 id=\"3-1-配置文件初始化\"><a href=\"#3-1-配置文件初始化\" class=\"headerlink\" title=\"3.1 配置文件初始化\"></a>3.1 配置文件初始化</h3><p>复制环境变量模版文件。注意：生产环境密钥或特定基础设施配置（如 AWS Keys）需单独配置，不应包含在仓库中。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cp</span> .env.example .<span class=\"built_in\">env</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-2-启动容器栈\"><a href=\"#3-2-启动容器栈\" class=\"headerlink\" title=\"3.2 启动容器栈\"></a>3.2 启动容器栈</h3><p>拥有 <code>vendor</code> 目录后，即可正常调用 Sail：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 启动环境</span></span><br><span class=\"line\">sail up -d</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 生成应用密钥</span></span><br><span class=\"line\">sail artisan key:generate</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 执行数据库迁移</span></span><br><span class=\"line\">sail artisan migrate</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"4-验证与总结\"><a href=\"#4-验证与总结\" class=\"headerlink\" title=\"4. 验证与总结\"></a>4. 验证与总结</h2><p>访问 <code>http://localhost</code> 确认服务运行正常。</p>\n<p>至此，我们建立了一套基于 <strong>Git + Docker Bootstrapping</strong> 的标准化工作流：</p>\n<ol>\n<li><strong>提交</strong>：仅提交业务代码与声明文件 (<code>composer.json</code>, <code>docker-compose.yml</code>).</li>\n<li><strong>拉取</strong>：在任意新设备获取代码。</li>\n<li><strong>引导</strong>：使用 <code>docker run</code> 引导安装依赖。</li>\n<li><strong>启动</strong>：使用 <code>sail up</code> 一键拉起完整环境。</li>\n</ol>\n<p>这种工作流确保了，无论在哪台设备，只要有 Docker，就能 100% 复刻出完全一致的开发环境。</p>\n",
            "tags": [
                "Git",
                "GitHub",
                "Laravel",
                "Sail"
            ]
        },
        {
            "id": "https://nightingalewk.cn/2025/06/26/74.%20%E4%BF%AE%E6%94%B9%E7%BA%BF%E4%B8%8A%20git%20%E4%BB%93%E5%BA%93%20master%20%E4%B8%BB%E5%88%86%E6%94%AF%E4%B8%BA%20main/",
            "url": "https://nightingalewk.cn/2025/06/26/74.%20%E4%BF%AE%E6%94%B9%E7%BA%BF%E4%B8%8A%20git%20%E4%BB%93%E5%BA%93%20master%20%E4%B8%BB%E5%88%86%E6%94%AF%E4%B8%BA%20main/",
            "title": "如何将 Git 仓库的默认分支从 master 修改为 main",
            "date_published": "2025-06-26T01:15:00.000Z",
            "content_html": "<p>随着技术社区对包容性语言的倡导，将 Git 仓库的默认分支从 <code>master</code> 修改为 <code>main</code> 已成为一种普遍的推荐做法。本文将提供一个详细、安全的操作指南，帮助你顺利完成这一迁移。</p>\n<p>整个过程主要分为四个核心步骤，外加一个针对团队协作的同步步骤。我们将依次进行操作，确保万无一失。</p>\n<h2 id=\"1-重命名本地分支\"><a href=\"#1-重命名本地分支\" class=\"headerlink\" title=\"1. 重命名本地分支\"></a>1. 重命名本地分支</h2><p>首先，我们需要在本地的 Git 仓库中进行操作。打开你的项目终端或命令行工具。</p>\n<ol>\n<li><p><strong>切换到 <code>master</code> 分支并拉取最新代码</strong>，确保本地与远程是同步的。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git checkout master</span><br><span class=\"line\">git pull origin master</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>使用 <code>-m</code> (<code>--move</code>) 参数重命名分支</strong>。这将把本地的 <code>master</code> 分支直接更名为 <code>main</code>。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git branch -m master main</span><br></pre></td></tr></table></figure>\n<p>执行后，你的本地主分支名就修改完成了。</p>\n</li>\n</ol>\n<h2 id=\"2-推送新分支到远程仓库\"><a href=\"#2-推送新分支到远程仓库\" class=\"headerlink\" title=\"2. 推送新分支到远程仓库\"></a>2. 推送新分支到远程仓库</h2><p>本地分支改名后，需要将这个新的 <code>main</code> 分支推送到你的远程仓库（如 GitHub 或 GitLab），并建立跟踪关系。</p>\n<ol>\n<li><strong>推送 <code>main</code> 分支</strong>。使用 <code>-u</code> (<code>--set-upstream</code>) 参数，这样 Git 会记住本地 <code>main</code> 分支对应远程的 <code>main</code> 分支，方便以后直接使用 <code>git push</code> 和 <code>git pull</code>。<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git push -u origin main</span><br></pre></td></tr></table></figure>\n此时，你的远程仓库会同时存在 <code>master</code> 和 <code>main</code> 两个分支，它们的内容完全相同。</li>\n</ol>\n<h2 id=\"3-修改平台的默认分支（关键步骤）\"><a href=\"#3-修改平台的默认分支（关键步骤）\" class=\"headerlink\" title=\"3. 修改平台的默认分支（关键步骤）\"></a>3. 修改平台的默认分支（关键步骤）</h2><p>这是整个流程中最关键的一步，必须在代码托管平台的网页上完成。**只有修改了默认分支，新的克隆 (clone) 和拉取请求 (Pull Request) 才会默认指向 <code>main</code>**。</p>\n<p>以 <strong>GitHub</strong> 为例：</p>\n<ol>\n<li>进入你的仓库主页，点击右上角的 <strong>Settings</strong> (设置)。</li>\n<li>在左侧菜单栏找到并点击 <strong>Branches</strong> (分支)。</li>\n<li>在 “Default branch” (默认分支) 区域，点击切换按钮（通常是两个箭头图标）。</li>\n<li>在弹出的窗口中，将默认分支从 <code>master</code> 选为 <code>main</code>，然后点击 <strong>Update</strong> 确认。</li>\n</ol>\n<p>其他平台（如 GitLab, Gitee）的操作也类似，通常都在仓库的“设置”或“仓库管理”中的“分支”选项里。</p>\n<h2 id=\"4-清理远程的-master-分支\"><a href=\"#4-清理远程的-master-分支\" class=\"headerlink\" title=\"4. 清理远程的 master 分支\"></a>4. 清理远程的 master 分支</h2><p>在确认 <code>main</code> 已成为默认分支，并且所有相关的自动化流程（如 CI&#x2F;CD）都已更新后，你就可以安全地删除远程的 <code>master</code> 分支了，以避免团队成员产生混淆。</p>\n<ol>\n<li><strong>执行删除命令</strong>：<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git push origin --delete master</span><br></pre></td></tr></table></figure></li>\n</ol>\n<p>至此，你的仓库就完全迁移到 <code>main</code> 作为主分支了。</p>\n<h2 id=\"注意事项与协作者指南\"><a href=\"#注意事项与协作者指南\" class=\"headerlink\" title=\"注意事项与协作者指南\"></a>注意事项与协作者指南</h2><p>如果你的项目是多人协作的，请务必通知所有成员，并让他们在自己的本地仓库执行以下命令来同步变更：</p>\n<pre><code class=\"bash\"># 1. 切换到旧的 master 分支\ngit checkout master\n\n# 2. 从远程拉取最新的分支结构信息\ngit fetch origin\n\n# 3. 将本地的 master 也重命名为 main\ngit branch -m master main\n\n# 4. 重新设置本地 main 分支去跟踪远程的 main 分支\ngit branch --set-upstream-to=origin/main main\n\n# 5. (推荐) 清理本地无效的远程跟踪分支\ngit remote prune origin\n</code></pre>\n",
            "tags": [
                "教程",
                "Git",
                "GitHub",
                "版本控制"
            ]
        }
    ]
}