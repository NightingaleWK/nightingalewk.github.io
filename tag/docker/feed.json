{
    "version": "https://jsonfeed.org/version/1",
    "title": "é›ªæ¼«åŸçš„é£å®… â€¢ All posts by \"docker\" tag",
    "description": "ã“ã®ä¸–ç•Œã¯å¥½éƒ½åˆã«æœªå®Œæˆ ã ã‹ã‚‰çŸ¥ã‚ŠãŸã„ã‚“ã  â€”â€” ãƒã€‚-åœ°çƒã®é‹å‹•ã«ã¤ã„ã¦-",
    "home_page_url": "https://nightingalewk.cn",
    "items": [
        {
            "id": "https://nightingalewk.cn/2026/01/23/83.%20Laravel%20Sail%20%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2%E4%B8%80%E6%8A%8A%E8%BF%87%EF%BC%88%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E7%AF%87%EF%BC%89/",
            "url": "https://nightingalewk.cn/2026/01/23/83.%20Laravel%20Sail%20%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2%E4%B8%80%E6%8A%8A%E8%BF%87%EF%BC%88%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E7%AF%87%EF%BC%89/",
            "title": "Laravel Sail å¼€å‘ç¯å¢ƒéƒ¨ç½²ä¸€æŠŠè¿‡ï¼ˆç¯å¢ƒé…ç½®ç¯‡ï¼‰",
            "date_published": "2026-01-23T10:00:00.000Z",
            "content_html": "<h1 id=\"ç›®æ ‡\"><a href=\"#ç›®æ ‡\" class=\"headerlink\" title=\"ç›®æ ‡\"></a>ç›®æ ‡</h1><p>æœ¬æ–‡çš„ç›®æ ‡éå¸¸æ˜ç¡®ï¼š<strong>ä»ä¸€å°åˆšè£…å¥½ç³»ç»Ÿçš„å…¨æ–° Windows 11 ç”µè„‘å¼€å§‹ï¼Œç›´åˆ°æµè§ˆå™¨æˆåŠŸè®¿é—® Laravel é»˜è®¤æ¬¢è¿é¡µé¢ã€‚</strong></p>\n<p>ä¸­é—´æˆ‘ä»¬å°†å®Œæˆï¼š</p>\n<ol>\n<li>å¼€å¯ BIOS è™šæ‹ŸåŒ–ã€‚</li>\n<li>å®‰è£… WSL 2 (Windows Subsystem for Linux)ã€‚</li>\n<li>å®‰è£… Docker Desktopã€‚</li>\n<li>ä½¿ç”¨ Sail å‘½ä»¤è¡Œä¸€é”®åˆ›å»ºå¹¶å¯åŠ¨é¡¹ç›®ã€‚</li>\n</ol>\n<blockquote>\n<p><strong>å‰ç½®è¦æ±‚</strong>ï¼šä½ çš„ Windows 11 ç‰ˆæœ¬éœ€è¦æ˜¯æœ€æ–°çš„ï¼ˆæˆ–è€…è‡³å°‘æ˜¯è¿‘ä¸¤å¹´çš„ç‰ˆæœ¬ï¼‰ã€‚</p>\n</blockquote>\n<hr>\n<h1 id=\"ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥è™šæ‹ŸåŒ–-Virtualization\"><a href=\"#ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥è™šæ‹ŸåŒ–-Virtualization\" class=\"headerlink\" title=\"ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥è™šæ‹ŸåŒ– (Virtualization)\"></a>ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥è™šæ‹ŸåŒ– (Virtualization)</h1><p>Docker å’Œ WSL2 çš„è¿è¡Œä¾èµ–äº CPU çš„è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚</p>\n<ol>\n<li>æ‰“å¼€ <strong>ä»»åŠ¡ç®¡ç†å™¨ (Task Manager)</strong> (<code>Ctrl + Shift + Esc</code>)ã€‚</li>\n<li>åˆ‡æ¢åˆ° <strong>æ€§èƒ½ (Performance)</strong> -&gt; <strong>CPU</strong> é€‰é¡¹å¡ã€‚</li>\n<li>æŸ¥çœ‹å³ä¸‹è§’çš„ <strong>è™šæ‹ŸåŒ– (Virtualization)</strong> çŠ¶æ€ã€‚<ul>\n<li>**å·²å¯ç”¨ (Enabled)**ï¼šâœ…é€šè¿‡ï¼Œç›´æ¥è¿›å…¥ä¸‹ä¸€æ­¥ã€‚</li>\n<li>**å·²ç¦ç”¨ (Disabled)**ï¼šâŒéœ€è¦é‡å¯ç”µè„‘è¿›å…¥ BIOS å¼€å¯ã€‚ä¸åŒå“ç‰Œä¸»æ¿å¼€å¯æ–¹å¼ä¸åŒï¼ˆé€šå¸¸åœ¨ <code>Advanced</code> -&gt; <code>CPU Configuration</code> -&gt; <code>Intel VT-x</code> æˆ– <code>AMD-V</code>ï¼‰ï¼Œè¯·è‡ªè¡Œæœç´¢â€œä¸»æ¿å“ç‰Œ + å¼€å¯è™šæ‹ŸåŒ–â€ã€‚</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h1 id=\"ç¬¬äºŒæ­¥ï¼šå®‰è£…-WSL-2\"><a href=\"#ç¬¬äºŒæ­¥ï¼šå®‰è£…-WSL-2\" class=\"headerlink\" title=\"ç¬¬äºŒæ­¥ï¼šå®‰è£… WSL 2\"></a>ç¬¬äºŒæ­¥ï¼šå®‰è£… WSL 2</h1><p>ç°åœ¨çš„ Windows å®‰è£… Linux å­ç³»ç»Ÿå·²ç»ç®€å•åˆ°ä»¤äººå‘æŒ‡ï¼Œä¸éœ€è¦å†å»æ§åˆ¶é¢æ¿å‹¾é€‰é‚£ä¸€å †å¤æ‚çš„â€œWindows åŠŸèƒ½â€äº†ã€‚</p>\n<ol>\n<li>é¼ æ ‡å³é”®ç‚¹å‡» <strong>å¼€å§‹èœå•</strong>ï¼Œé€‰æ‹© <strong>ç»ˆç«¯ç®¡ç†å‘˜ (Terminal Admin)</strong> æˆ– **PowerShell (ç®¡ç†å‘˜)**ã€‚</li>\n<li>è¾“å…¥ä»¥ä¸‹å‘½ä»¤å¹¶å›è½¦ï¼š<figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wsl <span class=\"literal\">--install</span></span><br></pre></td></tr></table></figure></li>\n<li><strong>ç­‰å¾…è¿›åº¦æ¡è·‘å®Œ</strong>ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£… Ubuntu å‘è¡Œç‰ˆã€‚</li>\n<li><strong>é‡å¯ç”µè„‘</strong>ã€‚</li>\n</ol>\n<blockquote>\n<p><strong>é‡å¯åçš„æ“ä½œ</strong>ï¼š<br>ç”µè„‘é‡å¯åï¼Œä¼šè‡ªåŠ¨å¼¹å‡ºä¸€ä¸ªé»‘è‰²çš„ç»ˆç«¯çª—å£ï¼ˆUbuntuï¼‰ã€‚å®ƒä¼šæç¤ºä½ ï¼š</p>\n<ul>\n<li>Enter new UNIX username: ï¼ˆè¾“å…¥ä½ æƒ³ç”¨çš„ç”¨æˆ·åï¼Œå…¨å°å†™ï¼Œå¦‚ <code>wang</code>ï¼‰</li>\n<li>Enter new UNIX password: ï¼ˆè®¾ç½®å¯†ç ï¼Œè¾“å…¥æ—¶å±å¹•ä¸ä¼šæ˜¾ç¤ºï¼Œè¾“å®Œå›è½¦å³å¯ï¼‰</li>\n<li>Retype new UNIX password: ï¼ˆç¡®è®¤å¯†ç ï¼‰</li>\n</ul>\n<p>æå®šåï¼Œå¦‚æœä½ é€šè¿‡ <code>wsl -l -v</code> å‘½ä»¤æŸ¥çœ‹ï¼Œåº”è¯¥èƒ½çœ‹åˆ°ä¸€ä¸ª <code>Ubuntu</code> æ­£åœ¨è¿è¡Œï¼Œä¸” Version ä¸º 2ã€‚</p>\n</blockquote>\n<hr>\n<h1 id=\"ç¬¬ä¸‰æ­¥ï¼šå®‰è£…-Docker-Desktop\"><a href=\"#ç¬¬ä¸‰æ­¥ï¼šå®‰è£…-Docker-Desktop\" class=\"headerlink\" title=\"ç¬¬ä¸‰æ­¥ï¼šå®‰è£… Docker Desktop\"></a>ç¬¬ä¸‰æ­¥ï¼šå®‰è£… Docker Desktop</h1><p>Docker Desktop æ˜¯ Docker åœ¨ Windows ä¸Šçš„å›¾å½¢åŒ–ç®¡ç†å·¥å…·ï¼Œå®ƒä¼šè‡ªåŠ¨æ¥ç®¡ WSL2 ä¸­çš„ Docker åç«¯ã€‚</p>\n<ol>\n<li>å‰å¾€ <a href=\"https://www.docker.com/products/docker-desktop/\">Docker å®˜ç½‘</a> ä¸‹è½½ <strong>Docker Desktop for Windows</strong>ã€‚</li>\n<li>åŒå‡»å®‰è£…ã€‚<strong>æ³¨æ„</strong>ï¼šåœ¨å®‰è£…ç•Œé¢çš„ Configuration æ­¥éª¤ä¸­ï¼ŒåŠ¡å¿…å‹¾é€‰ï¼š<ul>\n<li>âœ… <strong>Use WSL 2 instead of Hyper-V (recommended)</strong></li>\n</ul>\n</li>\n<li>å®‰è£…å®Œæˆåï¼Œæ‰“å¼€ Docker Desktopã€‚<ul>\n<li>å®ƒå¯èƒ½ä¼šè®©ä½ ç™»å½•ï¼Œä½ å¯ä»¥é€‰æ‹© Skip æš‚æ—¶è·³è¿‡ã€‚</li>\n<li>çœ‹åˆ°å·¦ä¸‹è§’å˜ä¸º <strong>ç»¿è‰²</strong> çš„ Engine runningï¼Œè¯´æ˜ Docker å¯åŠ¨æˆåŠŸã€‚</li>\n</ul>\n</li>\n</ol>\n<blockquote>\n<p><strong>å…³é”®é…ç½®ï¼šå¼€å¯ WSL é›†æˆ</strong></p>\n<ol>\n<li>ç‚¹å‡» Docker Desktopå³ä¸Šè§’çš„é½¿è½®å›¾æ ‡ âš™ï¸ (Settings)ã€‚</li>\n<li>è¿›å…¥ <strong>Resources</strong> -&gt; <strong>WSL Integration</strong>ã€‚</li>\n<li>ç¡®ä¿ â€œEnable integration with my default WSL distroâ€ æ˜¯ <strong>å‹¾é€‰</strong> çŠ¶æ€ã€‚</li>\n<li>å¦‚æœä¸‹æ–¹å‡ºç°äº† <code>Ubuntu</code> çš„å¼€å…³ï¼Œä¹ŸæŠŠå®ƒæ‰“å¼€ (Toggle On)ã€‚</li>\n<li>ç‚¹å‡» <strong>Apply &amp; Restart</strong>ã€‚</li>\n</ol>\n</blockquote>\n<hr>\n<h1 id=\"ç¬¬å››æ­¥ï¼šåˆ›å»ºå¹¶å¯åŠ¨-Laravel-é¡¹ç›®\"><a href=\"#ç¬¬å››æ­¥ï¼šåˆ›å»ºå¹¶å¯åŠ¨-Laravel-é¡¹ç›®\" class=\"headerlink\" title=\"ç¬¬å››æ­¥ï¼šåˆ›å»ºå¹¶å¯åŠ¨ Laravel é¡¹ç›®\"></a>ç¬¬å››æ­¥ï¼šåˆ›å»ºå¹¶å¯åŠ¨ Laravel é¡¹ç›®</h1><p>è§è¯å¥‡è¿¹çš„æ—¶åˆ»åˆ°äº†ã€‚æˆ‘ä»¬æ‰€æœ‰çš„æ“ä½œéƒ½åœ¨ WSL (Ubuntu) ä¸­è¿›è¡Œã€‚</p>\n<ol>\n<li><p>æ‰“å¼€ <strong>Windows Terminal</strong>ï¼Œç‚¹å‡»æ ‡é¢˜æ çš„ä¸‹æ‹‰ç®­å¤´ï¼Œé€‰æ‹© <strong>Ubuntu</strong> è¿™é‡Œå°±æ˜¯ä½ çš„ Linux ä¸–ç•Œã€‚</p>\n</li>\n<li><p><strong>åˆ›å»ºå¹¶è¿›å…¥ä»£ç ç›®å½•</strong>ï¼š<br>ä¸ºäº†ä¿æŒï¼ˆä¹Ÿå°±æ˜¯ Linux ç³»ç»Ÿé‡Œçš„å®¶ç›®å½•ï¼‰æ•´æ´ï¼Œæˆ‘ä»¬æ¨èæ–°å»ºä¸€ä¸ª <code>code</code> æ–‡ä»¶å¤¹æ¥å­˜æ”¾æœªæ¥çš„æ‰€æœ‰é¡¹ç›®ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> ~</span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> code</span><br><span class=\"line\"><span class=\"built_in\">cd</span> code</span><br></pre></td></tr></table></figure></li>\n<li><p><strong>ç›´æ¥è¿è¡Œ Laravel å®˜æ–¹æ„å»ºå‘½ä»¤</strong>ï¼š<br>æŠŠä¸‹é¢çš„ <code>example-app</code> æ¢æˆä½ æƒ³è¦çš„é¡¹ç›®åå­—ï¼ˆæ¯”å¦‚ <code>blog</code>ï¼‰ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -s https://laravel.build/example-app | bash</span><br></pre></td></tr></table></figure>\n<ul>\n<li>è¿™è¡Œå‘½ä»¤ä¼šè‡ªåŠ¨æ‹‰å–ç”± Laravel å®˜æ–¹ç»´æŠ¤çš„ Docker é•œåƒï¼Œå¹¶å¼€å§‹ä¸‹è½½æ‰€æœ‰ä¾èµ–ã€‚ç¬¬ä¸€æ¬¡è¿è¡Œå¯èƒ½ä¼šå—ç½‘é€Ÿå½±å“ï¼Œè¯·è€å¿ƒç­‰å¾…ï¼ˆå»ºè®®ç§‘å­¦ä¸Šç½‘ç¯å¢ƒï¼Œæˆ–è€…é…ç½® Docker é•œåƒåŠ é€Ÿï¼‰ã€‚</li>\n</ul>\n</li>\n<li><p><strong>è¿›å…¥é¡¹ç›®ç›®å½•</strong>ï¼š<br>å½“å‘½ä»¤è·‘å®Œï¼Œæç¤º â€œThank you! We hope you build something incredible.â€ æ—¶ï¼Œæ‰§è¡Œï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> example-app</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>é…ç½®å¿«æ·æŒ‡ä»¤ï¼ˆå¼ºçƒˆæ¨èï¼‰</strong>ï¼š<br>æ¯æ¬¡éƒ½è¾“å…¥ <code>./vendor/bin/sail</code> å¤ªéº»çƒ¦äº†ã€‚æˆ‘ä»¬é…ç½®ä¸€ä¸ª <code>sail</code>åˆ«åï¼ˆå®˜æ–¹æ¨èåšæ³•ï¼‰ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">&quot;alias sail=&#x27;[ -f sail ] &amp;&amp; bash sail || bash vendor/bin/sail&#x27;&quot;</span> &gt;&gt; ~/.bashrc</span><br><span class=\"line\"><span class=\"built_in\">source</span> ~/.bashrc</span><br></pre></td></tr></table></figure>\n<p><em>è¿™æ ·ä»¥åä½ åœ¨ä»»ä½•ç›®å½•ä¸‹ï¼Œåªè¦æ•² <code>sail</code> å°±èƒ½è°ƒç”¨å‘½ä»¤äº†ã€‚</em></p>\n</li>\n<li><p>**å¯åŠ¨ Sail (Docker ç¯å¢ƒ)**ï¼š</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sail up -d</span><br></pre></td></tr></table></figure>\n<ul>\n<li><code>up</code>ï¼šå¯åŠ¨æœåŠ¡ã€‚</li>\n<li><code>-d</code>ï¼šåå°è¿è¡Œ (Detached mode)ï¼Œè¿™æ ·ä½ çš„ç»ˆç«¯çª—å£ä¸ä¼šè¢«æ—¥å¿—éœ¸å ã€‚</li>\n</ul>\n<p><em>ç¬¬ä¸€æ¬¡å¯åŠ¨ä¼šæ‹‰å– MySQLã€Redis ç­‰é•œåƒï¼Œå¯èƒ½éœ€è¦ä¸€ç‚¹æ—¶é—´ã€‚</em></p>\n</li>\n</ol>\n<hr>\n<h1 id=\"ç¬¬äº”æ­¥ï¼šéªŒè¯æˆæœ\"><a href=\"#ç¬¬äº”æ­¥ï¼šéªŒè¯æˆæœ\" class=\"headerlink\" title=\"ç¬¬äº”æ­¥ï¼šéªŒè¯æˆæœ\"></a>ç¬¬äº”æ­¥ï¼šéªŒè¯æˆæœ</h1><p>æ‰“å¼€ä½ çš„æµè§ˆå™¨ï¼ˆChrome&#x2F;Edgeï¼‰ï¼Œåœ¨åœ°å€æ è¾“å…¥ï¼š</p>\n<blockquote>\n<p><strong><a href=\"http://localhost/\">http://localhost</a></strong></p>\n</blockquote>\n<p>å¦‚æœä½ çœ‹åˆ°é‚£ä¸ªå·¨å¤§çš„ã€çº¢è‰²çš„ï¼ˆæˆ–ç™½è‰²çš„ï¼‰Laravel Logoï¼Œä»¥åŠé†’ç›®çš„ç‰ˆæœ¬å·ã€‚</p>\n<p>ğŸ‰ <strong>æ­å–œä½ ï¼ä½ å·²ç»æˆåŠŸåœ¨ Windows ä¸Šéƒ¨ç½²äº†ä¸€å¥—æœ€å…ˆè¿›çš„ Laravel Docker å¼€å‘ç¯å¢ƒï¼</strong></p>\n<p>æ­¤æ—¶ï¼š</p>\n<ul>\n<li>ä½ çš„ç”µè„‘é‡Œæ²¡æœ‰å®‰è£… PHPã€‚</li>\n<li>ä½ çš„ç”µè„‘é‡Œæ²¡æœ‰å®‰è£… MySQLã€‚</li>\n<li>ä½ çš„ç”µè„‘é‡Œæ²¡æœ‰å®‰è£… Nginxã€‚</li>\n<li><strong>ä½†å®ƒä»¬éƒ½åœ¨ä¸ºä½ æœåŠ¡ã€‚</strong></li>\n</ul>\n<hr>\n<h1 id=\"ä¸‹é›†é¢„å‘Š\"><a href=\"#ä¸‹é›†é¢„å‘Š\" class=\"headerlink\" title=\"ä¸‹é›†é¢„å‘Š\"></a>ä¸‹é›†é¢„å‘Š</h1><p>ç¯å¢ƒé€šäº†ï¼Œä»£ç ä¹Ÿåœ¨è·‘äº†ã€‚ä½†æˆ‘ä»¬æ€ä¹ˆæŠŠä»£ç å­˜èµ·æ¥ï¼Ÿæ€ä¹ˆåœ¨å…¬å¸å†™ä¸€åŠï¼Œå›å®¶æ¢å°ç”µè„‘æ‹‰ä¸‹æ¥æ¥ç€å†™ï¼Ÿ<br>ä¸‹ä¸€ç¯‡ï¼š<strong>ã€ŠLaravel Sail å¼€å‘ç¯å¢ƒéƒ¨ç½²ä¸€æŠŠè¿‡ï¼ˆGit åŒæ­¥ä¸å¤šæœºå¼€å‘ç¯‡ï¼‰ã€‹</strong>ï¼Œæˆ‘ä»¬å°†é…ç½® GitHub ä»“åº“ï¼Œå¹¶æ¼”ç¤ºâ€œå¼‚åœ°å¼€å‘ï¼Œæ— æ„Ÿåˆ‡æ¢â€çš„ä¸æ»‘ä½“éªŒã€‚</p>\n",
            "tags": [
                "Laravel",
                "Docker",
                "Sail",
                "WSL2"
            ]
        },
        {
            "id": "https://nightingalewk.cn/2025/10/13/80.%20Laravel%20%E9%A1%B9%E7%9B%AE%E5%AE%B9%E5%99%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E5%90%8E%EF%BC%8C%E8%B5%84%E6%BA%90%E9%93%BE%E6%8E%A5%E5%A4%9A%E5%87%BA%E4%B8%AA%2080%20%E7%AB%AF%E5%8F%A3%E5%AD%97%E6%A0%B7%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/",
            "url": "https://nightingalewk.cn/2025/10/13/80.%20Laravel%20%E9%A1%B9%E7%9B%AE%E5%AE%B9%E5%99%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E5%90%8E%EF%BC%8C%E8%B5%84%E6%BA%90%E9%93%BE%E6%8E%A5%E5%A4%9A%E5%87%BA%E4%B8%AA%2080%20%E7%AB%AF%E5%8F%A3%E5%AD%97%E6%A0%B7%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/",
            "title": "Laravel é¡¹ç›®å®¹å™¨åŒ–éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒåï¼Œèµ„æºé“¾æ¥å¤šå‡ºä¸ª 80 ç«¯å£å­—æ ·è§£å†³æ–¹æ¡ˆ",
            "date_published": "2025-10-13T02:00:00.000Z",
            "content_html": "<h2 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h2><p>æœ€è¿‘åœ¨é˜¿é‡Œäº‘æœåŠ¡å™¨ä¸Šéƒ¨ç½²ä¸€ä¸ªåŸºäº Laravel 12 + Filament v4 çš„é¡¹ç›®ï¼ˆä»£å·â€œåœŸè±†é£Ÿå ‚â€ï¼‰ï¼Œä½¿ç”¨ Docker Compose å®¹å™¨åŒ–éƒ¨ç½²ï¼Œåç«¯ Nginx + PHP-FPMï¼Œå‰ç«¯é€šè¿‡ Nginx Proxy Manager (NPM) å®ç° HTTPS åå‘ä»£ç†ã€‚éƒ¨ç½²å®Œæˆåï¼Œä¸€åˆ‡çœ‹ä¼¼æ­£å¸¸ï¼Œä½†è®¿é—®åº”ç”¨æ—¶å‘ç°å‰ç«¯èµ„æºï¼ˆå¦‚ Filament çš„ <code>app.js</code>ï¼‰çš„ URL è¢«é”™è¯¯ç”Ÿæˆæˆ <code>https://lynx.wkarrow.top:80/js/filament/filament/app.js?v=4.1.6.0</code>ï¼Œå¤šå‡ºçš„ <code>:80</code> ç«¯å£å¯¼è‡´æµè§ˆå™¨æ— æ³•åŠ è½½èµ„æºï¼ŒæŠ¥ 404 é”™è¯¯ã€‚</p>\n<p>è¿™ä¸æ˜¯ä»£ç  bugï¼Œè€Œæ˜¯å…¸å‹çš„ HTTPS ä»£ç†åˆ° HTTP åç«¯çš„å¤´éƒ¨ä¼ é€’é—®é¢˜ã€‚NPM é»˜è®¤å°† <code>X-Forwarded-Port</code> è®¾ç½®ä¸ºåç«¯ç«¯å£ 80ï¼Œè€Œ Laravel åœ¨ç”Ÿæˆèµ„äº§ URL æ—¶ä¼šæ ¹æ®æ­¤å¤´éƒ¨é™„åŠ ç«¯å£ï¼Œå¯¼è‡´ä¸ HTTPS scheme ä¸åŒ¹é…ã€‚</p>\n<p>æœ¬æ–‡è®°å½•äº†é—®é¢˜æ’æŸ¥ä¸æœ€ç»ˆè§£å†³æ–¹æ¡ˆï¼Œé‡ç‚¹åˆ†äº«åç«¯ Nginx çš„å¤‡é€‰ä¿®å¤æ–¹æ³•ï¼ˆé€‚ç”¨äº NPM é…ç½®æ— æ•ˆçš„æƒ…å†µï¼‰ã€‚å¸Œæœ›å¯¹ç±»ä¼¼éƒ¨ç½²é‡åˆ°å‘çš„å¼€å‘è€…æœ‰å¸®åŠ©ï¼</p>\n<h2 id=\"é—®é¢˜å¤ç°ä¸åˆ†æ\"><a href=\"#é—®é¢˜å¤ç°ä¸åˆ†æ\" class=\"headerlink\" title=\"é—®é¢˜å¤ç°ä¸åˆ†æ\"></a>é—®é¢˜å¤ç°ä¸åˆ†æ</h2><h3 id=\"ç¯å¢ƒæ¦‚è¿°\"><a href=\"#ç¯å¢ƒæ¦‚è¿°\" class=\"headerlink\" title=\"ç¯å¢ƒæ¦‚è¿°\"></a>ç¯å¢ƒæ¦‚è¿°</h3><ul>\n<li><strong>é¡¹ç›®</strong>ï¼šLaravel 12 + Filament v4ï¼Œä½¿ç”¨ Vite æ„å»ºå‰ç«¯èµ„æºã€‚</li>\n<li><strong>éƒ¨ç½²</strong>ï¼šDocker Composeï¼ˆ<code>docker-compose.internet.yml</code>ï¼‰ï¼ŒåŒ…å« app (PHP-FPM)ã€nginxã€mysqlã€redis ç­‰æœåŠ¡ã€‚</li>\n<li><strong>ä»£ç†</strong>ï¼šNPM ç›‘å¬ 443 ç«¯å£ï¼Œå¼ºåˆ¶ HTTPSï¼Œè½¬å‘åˆ°åç«¯ Nginx çš„ 80 ç«¯å£ã€‚</li>\n<li><strong>Nginx é…ç½®</strong>ï¼š<code>default.conf</code> ä¸­å·²ä¼ é€’ <code>X-Forwarded-*</code> å¤´éƒ¨åˆ° PHP-FPMã€‚</li>\n</ul>\n<h3 id=\"æ•…éšœç°è±¡\"><a href=\"#æ•…éšœç°è±¡\" class=\"headerlink\" title=\"æ•…éšœç°è±¡\"></a>æ•…éšœç°è±¡</h3><ul>\n<li>æ­£å¸¸é¢„æœŸï¼š<code>https://lynx.wkarrow.top/js/filament/filament/app.js?v=4.1.6.0</code></li>\n<li>å®é™…ç”Ÿæˆï¼š<code>https://lynx.wkarrow.top:80/js/filament/filament/app.js?v=4.1.6.0</code></li>\n<li>å½±å“ï¼šæµè§ˆå™¨ Network é¢æ¿æ˜¾ç¤ºèµ„æº 404ï¼Œåº”ç”¨ç•Œé¢ JS&#x2F;CSS åŠ è½½å¤±è´¥ï¼ŒFilament é¢æ¿æ— æ³•äº¤äº’ã€‚</li>\n</ul>\n<h3 id=\"æ ¹å› åˆ†æ\"><a href=\"#æ ¹å› åˆ†æ\" class=\"headerlink\" title=\"æ ¹å› åˆ†æ\"></a>æ ¹å› åˆ†æ</h3><ol>\n<li>NPM ä½œä¸ºå‰ç«¯ä»£ç†ï¼Œæ·»åŠ  <code>X-Forwarded-Proto: https</code> å’Œ <code>X-Forwarded-Port: 80</code>ï¼ˆåç«¯ç«¯å£ï¼‰ã€‚</li>\n<li>åç«¯ Nginx å°†è¿™äº›å¤´éƒ¨ä¼ é€’ç»™ PHP-FPMï¼ˆ<code>fastcgi_param HTTP_X_FORWARDED_PORT $http_x_forwarded_port;</code>ï¼‰ã€‚</li>\n<li>Laravel çš„ <code>Request</code> å¯¹è±¡ä¿¡ä»»ä»£ç†å¤´éƒ¨ï¼ˆ<code>config/trustedproxies.php</code>ï¼‰ï¼Œè¯»å– <code>X-Forwarded-Port=80</code>ã€‚</li>\n<li>URL ç”Ÿæˆå™¨ï¼ˆå¦‚ <code>asset()</code> æˆ– Filament çš„èµ„æº URLï¼‰æ£€æµ‹åˆ°ç«¯å£é HTTPS é»˜è®¤ 443ï¼Œæ•…é™„åŠ  <code>:80</code>ã€‚</li>\n<li>å‚è€ƒ Laravel 12 æ–‡æ¡£ï¼ˆHTTP Requests éƒ¨åˆ†ï¼‰ï¼š<code>request()-&gt;getPort()</code> ä¼˜å…ˆä» <code>X-Forwarded-Port</code> å–å€¼ï¼Œå¯¼è‡´ç•¸å½¢ URLã€‚</li>\n</ol>\n<p>è¿™æ˜¯ä¸€ä¸ªå¸¸è§ç—›ç‚¹ï¼Œå°¤å…¶åœ¨ Docker + åå‘ä»£ç†ç¯å¢ƒä¸­ã€‚</p>\n<h2 id=\"è§£å†³æ–¹æ¡ˆ\"><a href=\"#è§£å†³æ–¹æ¡ˆ\" class=\"headerlink\" title=\"è§£å†³æ–¹æ¡ˆ\"></a>è§£å†³æ–¹æ¡ˆ</h2><p>æˆ‘å…ˆå°è¯•äº†åœ¨ NPM çš„ Advanced é€‰é¡¹å¡æ·»åŠ  <code>proxy_set_header X-Forwarded-Port 443;</code>ï¼Œä½†ç”±äº NPM çš„è‡ªå®šä¹‰é…ç½®æœ‰æ—¶ä¸ç¨³å®šï¼ˆå¯èƒ½ä¸ç‰ˆæœ¬æˆ–ç¼“å­˜ç›¸å…³ï¼‰ï¼Œæœ€ç»ˆé€‰æ‹©äº†åç«¯ Nginx çš„å¤‡é€‰ä¿®å¤â€”â€”ç›´æ¥åœ¨ <code>default.conf</code> ä¸­è¦†ç›–ç«¯å£é€»è¾‘ã€‚è¿™æ–¹æ³•æ›´å¯é ï¼Œä¸”ä¸ä¾èµ–ä»£ç†å·¥å…·ã€‚</p>\n<h3 id=\"æ­¥éª¤ï¼šä¿®æ”¹åç«¯-Nginx-é…ç½®\"><a href=\"#æ­¥éª¤ï¼šä¿®æ”¹åç«¯-Nginx-é…ç½®\" class=\"headerlink\" title=\"æ­¥éª¤ï¼šä¿®æ”¹åç«¯ Nginx é…ç½®\"></a>æ­¥éª¤ï¼šä¿®æ”¹åç«¯ Nginx é…ç½®</h3><ol>\n<li><p><strong>ç¼–è¾‘é…ç½®æ–‡ä»¶</strong>ï¼šåœ¨é¡¹ç›®ç›®å½•ä¸‹ï¼Œæ‰“å¼€ <code>./docker-internet/nginx/default.conf</code>ï¼ˆæˆ–æŒ‚è½½è·¯å¾„ <code>/etc/nginx/conf.d/default.conf</code>ï¼‰ã€‚</p>\n</li>\n<li><p><strong>å®šä½ PHP å¤„ç†å—</strong>ï¼šæ‰¾åˆ° <code>location ~ \\.php$</code> éƒ¨åˆ†ï¼ˆå·²å­˜åœ¨ FastCGI é…ç½®ï¼‰ã€‚</p>\n</li>\n<li><p><strong>æ·»åŠ è¦†ç›–é€»è¾‘</strong>ï¼šåœ¨ <code>fastcgi_param</code> ç›¸å…³è¡Œåï¼Œæ’å…¥ä»¥ä¸‹ Nginx æŒ‡ä»¤ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">location ~ \\.php$ &#123;</span><br><span class=\"line\">    try_files $uri =404;</span><br><span class=\"line\">    fastcgi_split_path_info ^(.+\\.php)(/.+)$;</span><br><span class=\"line\">    fastcgi_pass app:9000;</span><br><span class=\"line\">    fastcgi_index index.php;</span><br><span class=\"line\">    include fastcgi_params;</span><br><span class=\"line\">    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class=\"line\">    fastcgi_param PATH_INFO $fastcgi_path_info;</span><br><span class=\"line\"></span><br><span class=\"line\">    # åŸæœ‰å¤´éƒ¨ä¼ é€’</span><br><span class=\"line\">    fastcgi_param HTTP_X_FORWARDED_FOR $http_x_forwarded_for;</span><br><span class=\"line\">    fastcgi_param HTTP_X_FORWARDED_PROTO $http_x_forwarded_proto;</span><br><span class=\"line\">    fastcgi_param HTTP_X_FORWARDED_HOST $http_x_forwarded_host;</span><br><span class=\"line\">    fastcgi_param HTTP_X_FORWARDED_PORT $http_x_forwarded_port;</span><br><span class=\"line\"></span><br><span class=\"line\">    # æ–°å¢ï¼šåŸºäº proto è¦†ç›–ç«¯å£ï¼Œç¡®ä¿ HTTPS æ—¶ä¸º 443</span><br><span class=\"line\">    set $real_port $http_x_forwarded_port;</span><br><span class=\"line\">    if ($http_x_forwarded_proto = &quot;https&quot;) &#123;</span><br><span class=\"line\">        set $real_port &quot;443&quot;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fastcgi_param HTTP_X_FORWARDED_PORT $real_port;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong>è§£é‡Š</strong>ï¼š<ul>\n<li><code>set $real_port $http_x_forwarded_port;</code>ï¼šé»˜è®¤ä½¿ç”¨ä¼ å…¥ç«¯å£ã€‚</li>\n<li><code>if ($http_x_forwarded_proto = &quot;https&quot;) &#123; set $real_port &quot;443&quot;; &#125;</code>ï¼šå¦‚æœ scheme æ˜¯ HTTPSï¼Œåˆ™å¼ºåˆ¶è¦†ç›–ä¸º 443ï¼ˆå¿½ç•¥åç«¯ 80ï¼‰ã€‚</li>\n<li>æœ€åç”¨ <code>$real_port</code> æ›¿æ¢åŸå‚æ•°ï¼Œç¡®ä¿ Laravel è¯»å–æ­£ç¡®ç«¯å£ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p><strong>ä¿å­˜å¹¶é‡å¯æœåŠ¡</strong>ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker compose -f docker-compose.internet.yml restart nginx</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>Nginx ä¼šä¼˜é›…é‡è½½ï¼Œæ— éœ€é‡å»ºæ•´ä¸ªå®¹å™¨ã€‚</li>\n</ul>\n</li>\n<li><p><strong>è¾…åŠ©ä¼˜åŒ–</strong>ï¼ˆå¯é€‰ï¼Œä½†æ¨èï¼‰ï¼š</p>\n<ul>\n<li>ç¡®è®¤ <code>.env</code> ä¸­çš„ <code>APP_URL=https://lynx.wkarrow.top</code>ï¼ˆæ— ç«¯å£ï¼‰ã€‚</li>\n<li>æ¸…é™¤ Laravel ç¼“å­˜ï¼š<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker compose -f docker-compose.internet.yml exec app php artisan config:clear</span><br><span class=\"line\">sudo docker compose -f docker-compose.internet.yml exec app php artisan cache:clear</span><br><span class=\"line\">sudo docker compose -f docker-compose.internet.yml exec app php artisan optimize</span><br></pre></td></tr></table></figure></li>\n</ul>\n</li>\n</ol>\n<h2 id=\"éªŒè¯ä¸æµ‹è¯•\"><a href=\"#éªŒè¯ä¸æµ‹è¯•\" class=\"headerlink\" title=\"éªŒè¯ä¸æµ‹è¯•\"></a>éªŒè¯ä¸æµ‹è¯•</h2><ul>\n<li><strong>æµè§ˆå™¨æµ‹è¯•</strong>ï¼šæ¸…ç©ºç¼“å­˜ï¼Œè®¿é—® <code>https://lynx.wkarrow.top</code>ï¼Œæ‰“å¼€ F12 &gt; Networkï¼Œæ£€æŸ¥èµ„æº URLï¼ˆå¦‚ <code>app.js</code>ï¼‰æ˜¯å¦æ—  <code>:80</code>ï¼Œå¹¶ç¡®è®¤ 200 OKã€‚</li>\n<li><strong>å‘½ä»¤è¡ŒéªŒè¯</strong>ï¼š<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -I https://lynx.wkarrow.top/js/filament/filament/app.js</span><br></pre></td></tr></table></figure>\né¢„æœŸè¿”å› 200ï¼Œæ— é‡å®šå‘æˆ– 404ã€‚</li>\n<li><strong>æ—¥å¿—æ£€æŸ¥</strong>ï¼šè‹¥ä»æœ‰é—®é¢˜ï¼ŒæŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼š<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker compose -f docker-compose.internet.yml logs nginx app | grep -i &quot;forwarded\\|port&quot;</span><br></pre></td></tr></table></figure></li>\n</ul>\n<p>ä¿®å¤åï¼ŒFilament é¢æ¿åŠ è½½é¡ºç•…ï¼Œå‰ç«¯äº¤äº’å®Œç¾ï¼</p>\n<h2 id=\"æ€»ç»“ä¸å»ºè®®\"><a href=\"#æ€»ç»“ä¸å»ºè®®\" class=\"headerlink\" title=\"æ€»ç»“ä¸å»ºè®®\"></a>æ€»ç»“ä¸å»ºè®®</h2><p>è¿™ä¸ªå‘è®©æˆ‘æ„è¯†åˆ°ï¼Œåœ¨å®¹å™¨åŒ–éƒ¨ç½²ä¸­ï¼Œä»£ç†å¤´éƒ¨çš„å¤„ç†è‡³å…³é‡è¦ã€‚ä¼˜å…ˆå°è¯• NPM çš„ Advanced é…ç½®ï¼Œå¦‚æœæ— æ•ˆï¼Œåç«¯ Nginx çš„ <code>if</code> é€»è¾‘æ˜¯ç¨³å¦¥å¤‡é€‰ã€‚æœªæ¥æ›´æ–°é¡¹ç›®æ—¶ï¼Œè®°å¾— git pull åæ£€æŸ¥æ­¤é…ç½®æ˜¯å¦è¦†ç›–ã€‚</p>\n<p>å¦‚æœæ‚¨ä¹Ÿé‡åˆ°ç±»ä¼¼é—®é¢˜ï¼Œæ¬¢è¿è¯„è®ºåŒºäº¤æµï¼é¡¹ç›®æºç åœ¨ <a href=\"https://github.com/NightingaleWK/lynx\">GitHub</a> å¼€æºä¸­ï¼Œæ˜Ÿæ ‡æ”¯æŒä¸‹ï½</p>\n<p><strong>å‚è€ƒ</strong>ï¼š</p>\n<ul>\n<li>Laravel 12 æ–‡æ¡£ï¼šHTTP Requests</li>\n<li>Nginx Proxy Manager å®˜æ–¹æŒ‡å—ï¼šAdvanced Tab</li>\n</ul>\n<hr>\n<p><em>æœ¬æ–‡åŸºäºå®é™…éƒ¨ç½²ç»éªŒæ’°å†™ï¼Œå¦‚æœ‰ç–‘é—®ï¼Œæ¬¢è¿è®¨è®ºã€‚</em></p>\n",
            "tags": [
                "Laravel",
                "Docker",
                "Nginx",
                "åå‘ä»£ç†",
                "NPM",
                "HTTPS",
                "é—®é¢˜æ’æŸ¥"
            ]
        },
        {
            "id": "https://nightingalewk.cn/2025/10/10/79.%20%E5%9C%A8%20Ubuntu%2024.04%20%E7%94%A8%20APT%20%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0%E7%9A%84%20Docker%20Engine%20%E7%9A%84%E6%96%B9%E6%B3%95/",
            "url": "https://nightingalewk.cn/2025/10/10/79.%20%E5%9C%A8%20Ubuntu%2024.04%20%E7%94%A8%20APT%20%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0%E7%9A%84%20Docker%20Engine%20%E7%9A%84%E6%96%B9%E6%B3%95/",
            "title": "åœ¨ Ubuntu 24.04 ç”¨ APT å®‰è£…æœ€æ–°çš„ Docker Engine çš„æ–¹æ³•",
            "date_published": "2025-10-10T02:00:00.000Z",
            "content_html": "<p>æ–‡æœ¬å°†è®°å½•å½“å‰å¦‚ä½•åœ¨é˜¿é‡Œäº‘ CES æœåŠ¡å™¨ä¸Šï¼Œä½¿ç”¨ APT æ–¹å¼ï¼Œå®‰è£…æœ€æ–°çš„ Docker Engine åˆ° Ubuntu Server 24.04 ä¸Šã€‚ä¸»è¦è§£å†³çš„æ˜¯å›½å†…å› ç½‘ç»œç¯å¢ƒå¯¼è‡´çš„èµ„æºæ— æ³•ä¸‹è½½ã€è·å–çš„é—®é¢˜ã€‚</p>\n<p>æœ¬æ–‡å…¨éƒ¨æ“ä½œæ˜¯åŸºäº<a href=\"https://docs.docker.com/engine/install/ubuntu/#install-using-the-repository\">å®˜æ–¹çš„å®Œæ•´æ–‡æ¡£</a>ï¼Œä»…å¯¹ç½‘ç»œæ•…éšœè¿›è¡Œäº†å¤„ç†ï¼Œå…¶ä»–æ­¥éª¤å‡æœªæ”¹å˜ã€‚</p>\n<h2 id=\"1-è®¾ç½®-Docker-çš„-apt-å­˜å‚¨åº“\"><a href=\"#1-è®¾ç½®-Docker-çš„-apt-å­˜å‚¨åº“\" class=\"headerlink\" title=\"1. è®¾ç½® Docker çš„ apt å­˜å‚¨åº“\"></a>1. è®¾ç½® Docker çš„ apt å­˜å‚¨åº“</h2><p>åœ¨å…¨æ–°å¹²å‡€çš„æœåŠ¡å™¨ä¸Šï¼Œé…ç½® apt å­˜å‚¨åº“ï¼ŒåŸæœ¬å®˜æ–¹çš„æ–¹æ³•æ˜¯è¿™æ ·çš„ï¼š</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Add Docker&#x27;s official GPG key:</span></span><br><span class=\"line\"><span class=\"built_in\">sudo</span> apt-get update</span><br><span class=\"line\"><span class=\"built_in\">sudo</span> apt-get install ca-certificates curl</span><br><span class=\"line\"><span class=\"built_in\">sudo</span> install -m 0755 -d /etc/apt/keyrings</span><br><span class=\"line\"><span class=\"built_in\">sudo</span> curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc</span><br><span class=\"line\"><span class=\"built_in\">sudo</span> <span class=\"built_in\">chmod</span> a+r /etc/apt/keyrings/docker.asc</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Add the repository to Apt sources:</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> \\</span><br><span class=\"line\">  <span class=\"string\">&quot;deb [arch=<span class=\"subst\">$(dpkg --print-architecture)</span> signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \\</span></span><br><span class=\"line\"><span class=\"string\">  <span class=\"subst\">$(. /etc/os-release &amp;&amp; echo <span class=\"string\">&quot;<span class=\"variable\">$&#123;UBUNTU_CODENAME:-<span class=\"variable\">$VERSION_CODENAME</span>&#125;</span>&quot;</span>)</span> stable&quot;</span> | \\</span><br><span class=\"line\">  <span class=\"built_in\">sudo</span> <span class=\"built_in\">tee</span> /etc/apt/sources.list.d/docker.list &gt; /dev/null</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">sudo</span> apt-get update</span><br></pre></td></tr></table></figure>\n\n<p>å¾ˆæ˜æ˜¾ï¼ŒåŸºäº docker.com çš„èµ„æºéƒ½è¢«å¢™çš„ä¸ƒä¸ƒå…«å…«äº†ï¼Œæ ¹æœ¬æ— æ³•é¡ºåˆ©æ‰§è¡Œå®Œæ¯•ï¼Œæˆ‘ä»¬è¿™é‡Œæ›¿æ¢é˜¿é‡Œæºï¼š</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æ·»åŠ é˜¿é‡Œäº‘é•œåƒç«™çš„ Docker GPG Key:</span></span><br><span class=\"line\">apt update</span><br><span class=\"line\">apt install ca-certificates curl</span><br><span class=\"line\">install -m 0755 -d /etc/apt/keyrings</span><br><span class=\"line\">curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | gpg --dearmor -o /etc/apt/keyrings/docker.gpg</span><br><span class=\"line\"><span class=\"built_in\">chmod</span> a+r /etc/apt/keyrings/docker.gpg</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ·»åŠ é˜¿é‡Œäº‘çš„ Docker APT è½¯ä»¶æºï¼ˆæ›¿æ¢å®˜æ–¹æºï¼‰</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> \\</span><br><span class=\"line\">  <span class=\"string\">&quot;deb [arch=<span class=\"subst\">$(dpkg --print-architecture)</span> signed-by=/etc/apt/keyrings/docker.gpg] https://mirrors.aliyun.com/docker-ce/linux/ubuntu \\</span></span><br><span class=\"line\"><span class=\"string\">  <span class=\"subst\">$(. /etc/os-release &amp;&amp; echo <span class=\"string\">&quot;<span class=\"variable\">$&#123;UBUNTU_CODENAME:-<span class=\"variable\">$VERSION_CODENAME</span>&#125;</span>&quot;</span>)</span> stable&quot;</span> | \\</span><br><span class=\"line\">  <span class=\"built_in\">tee</span> /etc/apt/sources.list.d/docker.list &gt; /dev/null</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å†æ¬¡æ›´æ–°ç´¢å¼•</span></span><br><span class=\"line\">apt update</span><br></pre></td></tr></table></figure>\n\n<p>è¿™é‡Œï¼Œè‹¥æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ debian ç­‰å…¶ä»–çš„å‘è¡Œç‰ˆï¼Œåˆ™éœ€è¦å°†ä¸Šè¿°çš„ <code>https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg</code> æ›¿æ¢ä¸º <code>https://mirrors.aliyun.com/docker-ce/linux/debian/gpg</code> å³å¯ã€‚ä¹Ÿå°±æ˜¯ <code>ubuntu</code> æ”¹ä¸º <code>debian</code>ï¼Œå…¶ä»–æ“ä½œç³»ç»Ÿä»¥æ­¤ç±»æ¨ã€‚</p>\n<h2 id=\"2-å®‰è£…-Docker-åŒ…\"><a href=\"#2-å®‰è£…-Docker-åŒ…\" class=\"headerlink\" title=\"2. å®‰è£… Docker åŒ…\"></a>2. å®‰è£… Docker åŒ…</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">sudo</span> apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin</span><br></pre></td></tr></table></figure>\n\n<p>åç»­çš„æŒ‰ç…§å®˜æ–¹æ–‡æ¡£æ“ä½œå³å¯ï¼Œä¸å†èµ˜è¿°äº†ã€‚</p>\n",
            "tags": [
                "Docker",
                "Ubuntu",
                "å®‰è£…æŒ‡å—",
                "é˜¿é‡Œäº‘",
                "é•œåƒæº"
            ]
        },
        {
            "id": "https://nightingalewk.cn/2025/10/09/78.%20Laravel%20%E9%A1%B9%E7%9B%AE%20Docker%20%E5%8C%96%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/",
            "url": "https://nightingalewk.cn/2025/10/09/78.%20Laravel%20%E9%A1%B9%E7%9B%AE%20Docker%20%E5%8C%96%E9%83%A8%E7%BD%B2%E4%B8%8E%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/",
            "title": "Laravel é¡¹ç›® Docker åŒ–éƒ¨ç½²ä¸è¿ç»´æ‰‹å†Œ",
            "date_published": "2025-10-09T08:00:00.000Z",
            "content_html": "<p>æœ¬æ–‡æ¡£è¯¦ç»†è®°å½•äº†å¦‚ä½•å°† â€œåœŸè±†é£Ÿå ‚â€ (Lynx) è¿™ä¸ª Laravel 12 é¡¹ç›®é€šè¿‡ Docker è¿›è¡Œå®¹å™¨åŒ–æ‰“åŒ…ã€éƒ¨ç½²ã€è¿è¡ŒåŠæ—¥å¸¸ç»´æŠ¤ã€‚</p>\n<p>ä¸ªäººé¡¹ç›®ï¼Œå·²å¼€æºï¼š<a href=\"https://github.com/NightingaleWK/lynx\">https://github.com/NightingaleWK/lynx</a></p>\n<h2 id=\"ä¸€ã€ç¯å¢ƒå‡†å¤‡\"><a href=\"#ä¸€ã€ç¯å¢ƒå‡†å¤‡\" class=\"headerlink\" title=\"ä¸€ã€ç¯å¢ƒå‡†å¤‡\"></a><strong>ä¸€ã€ç¯å¢ƒå‡†å¤‡</strong></h2><p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„éƒ¨ç½²ç›®æ ‡æœºå™¨ï¼ˆä¾‹å¦‚ Windows 11ï¼‰å·²å®‰è£…å¹¶è¿è¡Œ Docker Desktopã€‚</p>\n<h2 id=\"äºŒã€é¡¹ç›®æ”¹é€ ï¼ˆé¦–æ¬¡éƒ¨ç½²éœ€æ‰§è¡Œï¼‰\"><a href=\"#äºŒã€é¡¹ç›®æ”¹é€ ï¼ˆé¦–æ¬¡éƒ¨ç½²éœ€æ‰§è¡Œï¼‰\" class=\"headerlink\" title=\"äºŒã€é¡¹ç›®æ”¹é€ ï¼ˆé¦–æ¬¡éƒ¨ç½²éœ€æ‰§è¡Œï¼‰\"></a><strong>äºŒã€é¡¹ç›®æ”¹é€ ï¼ˆé¦–æ¬¡éƒ¨ç½²éœ€æ‰§è¡Œï¼‰</strong></h2><p>ä»¥ä¸‹æ–‡ä»¶éœ€è¦åœ¨æ‚¨æœ¬åœ°çš„é¡¹ç›®ä»£ç ä¸­åˆ›å»ºã€‚</p>\n<h3 id=\"1-ç›®å½•ç»“æ„\"><a href=\"#1-ç›®å½•ç»“æ„\" class=\"headerlink\" title=\"1. ç›®å½•ç»“æ„\"></a><strong>1. ç›®å½•ç»“æ„</strong></h3><p>ä¸ºäº†æ¸…æ™°åœ°åŒºåˆ†ç”Ÿäº§ç¯å¢ƒä¸ Sail å¼€å‘ç¯å¢ƒçš„é…ç½®ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰ç”Ÿäº§éƒ¨ç½²ç›¸å…³çš„æ–‡ä»¶éƒ½å­˜æ”¾åœ¨ä¸€ä¸ªæ–°çš„ docker-prod ç›®å½•ä¸­ã€‚</p>\n<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œåˆ›å»ºå¦‚ä¸‹çš„ç›®å½•å’Œæ–‡ä»¶ç»“æ„ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">your-laravel-project/</span><br><span class=\"line\">â”œâ”€â”€ docker-prod/ # &lt;-- æ–°å»ºï¼Œå­˜æ”¾æ‰€æœ‰ç”Ÿäº§ç¯å¢ƒé…ç½®</span><br><span class=\"line\">â”‚ â”œâ”€â”€ app/</span><br><span class=\"line\">â”‚ â”‚ â””â”€â”€ Dockerfile</span><br><span class=\"line\">â”‚ â””â”€â”€ nginx/</span><br><span class=\"line\">â”‚ â””â”€â”€ default.conf</span><br><span class=\"line\">â”œâ”€â”€ docker/# &lt;-- è¿™æ˜¯ Sail çš„å¼€å‘ç¯å¢ƒç›®å½• (ä¿ç•™ä¸å˜)</span><br><span class=\"line\">â”œâ”€â”€ docker-compose.prod.yml# &lt;-- æ–°å»º (æ³¨æ„æ–‡ä»¶å)</span><br><span class=\"line\">â””â”€â”€ .dockerignore# &lt;-- æ–°å»º</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-åˆ›å»ºæ ¸å¿ƒé…ç½®æ–‡ä»¶\"><a href=\"#2-åˆ›å»ºæ ¸å¿ƒé…ç½®æ–‡ä»¶\" class=\"headerlink\" title=\"2. åˆ›å»ºæ ¸å¿ƒé…ç½®æ–‡ä»¶\"></a><strong>2. åˆ›å»ºæ ¸å¿ƒé…ç½®æ–‡ä»¶</strong></h3><p>è¯·æ ¹æ®åç»­æä¾›çš„æ–‡ä»¶å†…å®¹ï¼Œåœ¨æ‚¨çš„é¡¹ç›®ä¸­åˆ›å»ºæˆ–æ›¿æ¢ä»¥ä¸‹æ–‡ä»¶ã€‚</p>\n<ul>\n<li>docker-compose.prod.yml (æœåŠ¡ç¼–æ’æ–‡ä»¶)</li>\n<li>docker-prod&#x2F;app&#x2F;Dockerfile (PHP åº”ç”¨é•œåƒæ„å»ºæ–‡ä»¶)</li>\n<li>docker-prod&#x2F;nginx&#x2F;default.conf (Nginx é…ç½®æ–‡ä»¶)</li>\n<li>.dockerignore (Docker å¿½ç•¥æ–‡ä»¶)</li>\n</ul>\n<h3 id=\"3-ä¿®æ”¹-Laravel-é…ç½®-env\"><a href=\"#3-ä¿®æ”¹-Laravel-é…ç½®-env\" class=\"headerlink\" title=\"3. ä¿®æ”¹ Laravel é…ç½® (.env)\"></a><strong>3. ä¿®æ”¹ Laravel é…ç½® (.env)</strong></h3><ol>\n<li>å¤åˆ¶ .env.example ä¸º .env æ–‡ä»¶ã€‚</li>\n<li><strong>å…³é”®ä¿®æ”¹</strong>ï¼šç¡®ä¿æ•°æ®åº“å’Œ Redis çš„ HOST æŒ‡å‘ Docker Compose ä¸­å®šä¹‰çš„æœåŠ¡åã€‚</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">APP_ENV=production</span><br><span class=\"line\">APP_DEBUG=false</span><br><span class=\"line\">APP_KEY= # ç•™ç©ºï¼Œåç»­ä¼šé€šè¿‡å‘½ä»¤ç”Ÿæˆ</span><br><span class=\"line\"></span><br><span class=\"line\">DB_CONNECTION=mysql</span><br><span class=\"line\">DB_HOST=mysql # &lt;-- å¿…é¡»æ˜¯ mysql</span><br><span class=\"line\">DB_PORT=3306</span><br><span class=\"line\">DB_DATABASE=lynx# æ‚¨çš„æ•°æ®åº“å</span><br><span class=\"line\">DB_USERNAME=sail# æ‚¨çš„ç”¨æˆ·å</span><br><span class=\"line\">DB_PASSWORD=password# æ‚¨çš„å¯†ç </span><br><span class=\"line\"></span><br><span class=\"line\">CACHE_DRIVER=redis</span><br><span class=\"line\">QUEUE_CONNECTION=redis</span><br><span class=\"line\">SESSION_DRIVER=redis</span><br><span class=\"line\"></span><br><span class=\"line\">REDIS_HOST=redis# &lt;-- å¿…é¡»æ˜¯ redis</span><br><span class=\"line\">REDIS_PASSWORD=null</span><br><span class=\"line\">REDIS_PORT=6379</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-ç”Ÿæˆ-SSL-è¯ä¹¦-å±€åŸŸç½‘-HTTPS\"><a href=\"#4-ç”Ÿæˆ-SSL-è¯ä¹¦-å±€åŸŸç½‘-HTTPS\" class=\"headerlink\" title=\"4. ç”Ÿæˆ SSL è¯ä¹¦ (å±€åŸŸç½‘ HTTPS)\"></a><strong>4. ç”Ÿæˆ SSL è¯ä¹¦ (å±€åŸŸç½‘ HTTPS)</strong></h3><ol>\n<li>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºç›®å½• docker-prod&#x2F;certsã€‚</li>\n<li>æ‰“å¼€ç»ˆç«¯ (å¦‚ Git Bash æˆ– WSL)ï¼Œè¿›å…¥é¡¹ç›®æ ¹ç›®å½•ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">openssl req -x509 -nodes -days 3650 -newkey rsa:2048 -keyout docker-prod/ certs/lynx-key.pem -out docker-prod/certs/lynx.pem</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li><strong>é‡è¦æç¤º</strong>ï¼šåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå½“æç¤ºè¾“å…¥ Common Name æ—¶ï¼Œ<strong>è¯·è¾“å…¥æ‚¨éƒ¨ç½²æœºå™¨çš„å±€åŸŸç½‘ IP åœ°å€</strong>ï¼ˆä¾‹å¦‚ 192.168.1.100ï¼‰ã€‚</li>\n<li>æ‰§è¡Œåï¼Œè¯·æ£€æŸ¥ docker-prod&#x2F;certs ç›®å½•ä¸‹æ˜¯å¦å·²ç”Ÿæˆ lynx.pem å’Œ lynx-key.pem ä¸¤ä¸ªæ–‡ä»¶ã€‚</li>\n</ol>\n<h2 id=\"ä¸‰ã€éƒ¨ç½²ä¸åˆå§‹åŒ–æµç¨‹\"><a href=\"#ä¸‰ã€éƒ¨ç½²ä¸åˆå§‹åŒ–æµç¨‹\" class=\"headerlink\" title=\"ä¸‰ã€éƒ¨ç½²ä¸åˆå§‹åŒ–æµç¨‹\"></a><strong>ä¸‰ã€éƒ¨ç½²ä¸åˆå§‹åŒ–æµç¨‹</strong></h2><h3 id=\"æ­¥éª¤-1ï¼šæ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰å®¹å™¨\"><a href=\"#æ­¥éª¤-1ï¼šæ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰å®¹å™¨\" class=\"headerlink\" title=\"æ­¥éª¤ 1ï¼šæ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰å®¹å™¨\"></a><strong>æ­¥éª¤ 1ï¼šæ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰å®¹å™¨</strong></h3><p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œæ‰“å¼€ç»ˆç«¯ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚æ­¤å‘½ä»¤ä¼šæ ¹æ® Dockerfile æ„å»ºåº”ç”¨é•œåƒï¼Œå¹¶ä»¥åå°æ¨¡å¼å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># --no-cache ç¡®ä¿ä½¿ç”¨æœ€æ–°çš„åŸºç¡€é•œåƒï¼Œé¿å…ç¼“å­˜é—®é¢˜</span></span><br><span class=\"line\"><span class=\"comment\"># --build å¼ºåˆ¶é‡æ–°æ„å»ºé•œåƒ</span></span><br><span class=\"line\">docker-compose -f docker-compose.prod.yml up -d --build --no-cache</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ­¥éª¤-2ï¼šåˆå§‹åŒ–-Laravel-åº”ç”¨\"><a href=\"#æ­¥éª¤-2ï¼šåˆå§‹åŒ–-Laravel-åº”ç”¨\" class=\"headerlink\" title=\"æ­¥éª¤ 2ï¼šåˆå§‹åŒ– Laravel åº”ç”¨\"></a><strong>æ­¥éª¤ 2ï¼šåˆå§‹åŒ– Laravel åº”ç”¨</strong></h3><p>å®¹å™¨é¦–æ¬¡å¯åŠ¨åï¼Œæ•°æ®åº“æ˜¯ç©ºçš„ï¼Œåº”ç”¨ä¹Ÿæ²¡æœ‰é…ç½®å¯†é’¥ã€‚æˆ‘ä»¬éœ€è¦è¿›å…¥ app å®¹å™¨æ‰§è¡Œä¸€ç³»åˆ—åˆå§‹åŒ–å‘½ä»¤ã€‚</p>\n<ol>\n<li><strong>ç”Ÿæˆåº”ç”¨å¯†é’¥ (APP_KEY)</strong>:</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose.prod.yml <span class=\"built_in\">exec</span> app php artisan key:generate</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>è¿è¡Œæ•°æ®åº“è¿ç§»:<br>æ­¤å‘½ä»¤ä¼šæ ¹æ® database&#x2F;migrations ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œåœ¨æ•°æ®åº“ä¸­åˆ›å»ºæ‰€æœ‰éœ€è¦çš„æ•°æ®è¡¨ï¼ˆåŒ…æ‹¬ cache è¡¨ç­‰ï¼‰ã€‚\\</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose.prod.yml <span class=\"built_in\">exec</span> app php artisan migrate</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>ä¿®æ­£ storage ç›®å½•æƒé™:<br>è¿™æ˜¯è§£å†³ â€œPermission deniedâ€ é”™è¯¯çš„å…³é”®æ­¥éª¤ã€‚æ­¤å‘½ä»¤å°†å®¹å™¨å†…çš„ storage å’Œ bootstrap&#x2F;cache ç›®å½•çš„æ‰€æœ‰æƒäº¤ç»™ php-fpm çš„è¿è¡Œç”¨æˆ· www-dataã€‚</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose.prod.yml <span class=\"built_in\">exec</span> app <span class=\"built_in\">chown</span> -R www-data:www-data storage bootstrap/cache</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>ï¼ˆå¯é€‰ï¼‰å¡«å……æµ‹è¯•æ•°æ®:<br>å¦‚æœæ‚¨éœ€è¦åœ¨æµ‹è¯•æ—¶å¡«å……æ•°æ®ï¼Œå¯ä»¥è¿è¡Œæ­¤å‘½ä»¤ã€‚è¯·æ³¨æ„ï¼Œç”Ÿäº§ç¯å¢ƒä¸åº”æ‰§è¡Œæ­¤æ“ä½œã€‚</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># --force å‚æ•°å¯ä»¥è·³è¿‡ç”Ÿäº§ç¯å¢ƒçš„ç¡®è®¤æç¤º</span></span><br><span class=\"line\">docker-compose -f docker-compose.prod.yml <span class=\"built_in\">exec</span> app php artisan db:seed --force</span><br></pre></td></tr></table></figure>\n\n<p><em>æ³¨ï¼šè‹¥éœ€å¡«å……æ•°æ®ï¼Œè¯·ç¡®ä¿ Dockerfile ä¸­ composer install å‘½ä»¤<strong>æ²¡æœ‰</strong>ä½¿ç”¨ â€“no-dev å‚æ•°ï¼Œä»¥ä¿è¯ Faker ç­‰å¼€å‘åŒ…è¢«å®‰è£…ã€‚</em></p>\n<h3 id=\"æ­¥éª¤-3ï¼šè®¿é—®æ‚¨çš„åº”ç”¨\"><a href=\"#æ­¥éª¤-3ï¼šè®¿é—®æ‚¨çš„åº”ç”¨\" class=\"headerlink\" title=\"æ­¥éª¤ 3ï¼šè®¿é—®æ‚¨çš„åº”ç”¨\"></a><strong>æ­¥éª¤ 3ï¼šè®¿é—®æ‚¨çš„åº”ç”¨</strong></h3><p>å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œæ‚¨çš„åº”ç”¨å·²ç»æˆåŠŸéƒ¨ç½²å¹¶è¿è¡Œã€‚</p>\n<ul>\n<li>æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® https:&#x2F;&#x2F;&lt;æ‚¨çš„éƒ¨ç½²æœºå™¨ IP&gt;ã€‚</li>\n<li>æµè§ˆå™¨ä¼šæç¤ºè¯ä¹¦ä¸å®‰å…¨ï¼Œè¯·é€‰æ‹©â€œé«˜çº§â€ -&gt; â€œç»§ç»­å‰å¾€â€ã€‚</li>\n<li>æ‚¨åº”è¯¥èƒ½çœ‹åˆ° Laravel çš„æ¬¢è¿é¡µé¢æˆ–æ‚¨çš„åº”ç”¨é¦–é¡µã€‚</li>\n</ul>\n<h2 id=\"å››ã€æ—¥å¸¸è¿ç»´å‘½ä»¤\"><a href=\"#å››ã€æ—¥å¸¸è¿ç»´å‘½ä»¤\" class=\"headerlink\" title=\"å››ã€æ—¥å¸¸è¿ç»´å‘½ä»¤\"></a><strong>å››ã€æ—¥å¸¸è¿ç»´å‘½ä»¤</strong></h2><h3 id=\"å¯åŠ¨-åœæ­¢æœåŠ¡\"><a href=\"#å¯åŠ¨-åœæ­¢æœåŠ¡\" class=\"headerlink\" title=\"å¯åŠ¨&#x2F;åœæ­¢æœåŠ¡\"></a><strong>å¯åŠ¨&#x2F;åœæ­¢æœåŠ¡</strong></h3><ul>\n<li><strong>å¯åŠ¨æ‰€æœ‰æœåŠ¡</strong> (åå°è¿è¡Œ):</li>\n</ul>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose.prod.yml up -d</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong>åœæ­¢å¹¶ç§»é™¤æ‰€æœ‰å®¹å™¨</strong>:</li>\n</ul>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose.prod.yml down</span><br></pre></td></tr></table></figure>\n\n<p><em>æ­¤æ“ä½œä¸ä¼šåˆ é™¤æ•°æ®åº“å’Œ Redis çš„æŒä¹…åŒ–æ•°æ®ã€‚</em></p>\n<h3 id=\"æŸ¥çœ‹çŠ¶æ€ä¸æ—¥å¿—\"><a href=\"#æŸ¥çœ‹çŠ¶æ€ä¸æ—¥å¿—\" class=\"headerlink\" title=\"æŸ¥çœ‹çŠ¶æ€ä¸æ—¥å¿—\"></a><strong>æŸ¥çœ‹çŠ¶æ€ä¸æ—¥å¿—</strong></h3><ul>\n<li><strong>æŸ¥çœ‹æ‰€æœ‰å®¹å™¨çš„è¿è¡ŒçŠ¶æ€</strong>:</li>\n</ul>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose.prod.yml ps</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong>å®æ—¶æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çš„æ—¥å¿—</strong>:</li>\n</ul>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose.prod.yml logs -f</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong>åªçœ‹ç‰¹å®šæœåŠ¡çš„æ—¥å¿—</strong> (ä¾‹å¦‚ app æˆ– queue-worker):</li>\n</ul>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose.prod.yml logs -f app</span><br><span class=\"line\">docker-compose -f docker-compose.prod.yml logs -f queue-worker</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ä»£ç æ›´æ–°æµç¨‹\"><a href=\"#ä»£ç æ›´æ–°æµç¨‹\" class=\"headerlink\" title=\"ä»£ç æ›´æ–°æµç¨‹\"></a><strong>ä»£ç æ›´æ–°æµç¨‹</strong></h3><p>å½“æ‚¨é€šè¿‡ git pull æ›´æ–°äº†é¡¹ç›®ä»£ç åï¼š</p>\n<ol>\n<li><strong>é‡æ–°æ„å»ºé•œåƒå¹¶é‡å¯æœåŠ¡</strong>:</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose.prod.yml up -d --build</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li><strong>ï¼ˆå¦‚æœéœ€è¦ï¼‰è¿è¡Œæ–°çš„æ•°æ®åº“è¿ç§»</strong>:</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose.prod.yml <span class=\"built_in\">exec</span> app php artisan migrate --force</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li><strong>ï¼ˆæ¨èï¼‰æ¸…ç†å¹¶é‡å»ºé…ç½®ç¼“å­˜</strong>:</li>\n</ol>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose.prod.yml <span class=\"built_in\">exec</span> app php artisan optimize:clear</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ‰§è¡Œ-Artisan-å‘½ä»¤\"><a href=\"#æ‰§è¡Œ-Artisan-å‘½ä»¤\" class=\"headerlink\" title=\"æ‰§è¡Œ Artisan å‘½ä»¤\"></a><strong>æ‰§è¡Œ Artisan å‘½ä»¤</strong></h3><p>æ‚¨å¯ä»¥åœ¨ app å®¹å™¨å†…æ‰§è¡Œä»»ä½• Artisan å‘½ä»¤ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker-compose -f docker-compose.prod.yml <span class=\"built_in\">exec</span> app php artisan &lt;æ‚¨çš„å‘½ä»¤&gt;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"äº”ã€å®Œæ•´é…ç½®æ–‡ä»¶ä»£ç \"><a href=\"#äº”ã€å®Œæ•´é…ç½®æ–‡ä»¶ä»£ç \" class=\"headerlink\" title=\"äº”ã€å®Œæ•´é…ç½®æ–‡ä»¶ä»£ç \"></a><strong>äº”ã€å®Œæ•´é…ç½®æ–‡ä»¶ä»£ç </strong></h2><p>ä¸ºäº†æ–¹ä¾¿æ‚¨å¿«é€Ÿéƒ¨ç½²ï¼Œä»¥ä¸‹æä¾›äº†æ–‡ä¸­æåŠçš„æ‰€æœ‰é…ç½®æ–‡ä»¶çš„å®Œæ•´ä»£ç ã€‚</p>\n<h3 id=\"1-docker-prod-app-Dockerfile\"><a href=\"#1-docker-prod-app-Dockerfile\" class=\"headerlink\" title=\"1. docker-prod&#x2F;app&#x2F;Dockerfile\"></a><strong>1. docker-prod&#x2F;app&#x2F;Dockerfile</strong></h3><p>æ­¤æ–‡ä»¶å®šä¹‰äº† PHP åº”ç”¨å®¹å™¨çš„æ„å»ºè§„åˆ™ï¼ŒåŸºäº PHP 8.4 FPM Alpine é•œåƒï¼Œå¹¶å®‰è£…äº† Laravel æ‰€éœ€çš„æ‰€æœ‰æ‰©å±•ã€‚</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1. åŸºç¡€é•œåƒå‡çº§åˆ° PHP 8.4</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> php:<span class=\"number\">8.4</span>-fpm-alpine</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è®¾ç½®å·¥ä½œç›®å½•</span></span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"language-bash\"> /var/www/html</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2. ä¼˜åŒ–æ„å»ºè¿‡ç¨‹ï¼šåˆå¹¶ä¾èµ–å®‰è£…ï¼Œå¹¶ä½¿ç”¨ virtual group ä»¥ä¾¿åç»­æ¸…ç†</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> apk add --no-cache \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    <span class=\"comment\"># æ ¸å¿ƒç³»ç»Ÿå·¥å…·</span></span></span><br><span class=\"line\">    zip \\</span><br><span class=\"line\">    unzip \\</span><br><span class=\"line\">    <span class=\"comment\"># PHP æ‰©å±•ä¾èµ–</span></span><br><span class=\"line\">    libzip-dev \\</span><br><span class=\"line\">    libpng-dev \\</span><br><span class=\"line\">    jpeg-dev \\</span><br><span class=\"line\">    freetype-dev \\</span><br><span class=\"line\">    icu-dev \\</span><br><span class=\"line\">    <span class=\"comment\"># åˆ›å»ºä¸€ä¸ªåä¸º .build-deps çš„ä¸´æ—¶æ„å»ºä¾èµ–ç»„</span></span><br><span class=\"line\">    &amp;&amp; apk <span class=\"keyword\">add</span><span class=\"language-bash\"> --no-cache --virtual .build-deps \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    <span class=\"variable\">$PHPIZE_DEPS</span> \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    zlib-dev \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    linux-headers</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3. å€Ÿé‰´ Sailï¼Œè¡¥å…¨ Laravel æ‰€éœ€çš„æ ¸å¿ƒæ‰©å±•</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> docker-php-ext-configure gd --with-freetype --with-jpeg \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    &amp;&amp; docker-php-ext-install -j$(<span class=\"built_in\">nproc</span>) \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    pdo_mysql \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    bcmath \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    gd \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    exif \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    intl \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    zip \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    pcntl \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    sockets \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    &amp;&amp; pecl install redis \\</span></span><br><span class=\"line\"><span class=\"language-bash\">    &amp;&amp; docker-php-ext-enable redis</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 4. æ¸…ç†å·¥ä½œï¼šåˆ é™¤ä¸´æ—¶çš„æ„å»ºä¾èµ–ï¼Œå‡å°é•œåƒä½“ç§¯</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> apk del .build-deps</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å®‰è£… Composer</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> --from=composer:latest /usr/bin/composer /usr/bin/composer</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ‹·è´ composer æ–‡ä»¶å¹¶å®‰è£…ä¾èµ–</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> composer.json composer.lock ./</span></span><br><span class=\"line\"><span class=\"comment\"># ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–ï¼šä¸å®‰è£…å¼€å‘ä¾èµ–ï¼Œå¹¶ä¼˜åŒ–è‡ªåŠ¨åŠ è½½</span></span><br><span class=\"line\"><span class=\"comment\"># æ³¨æ„ï¼šå¦‚æœéœ€è¦åœ¨å®¹å™¨å†…è¿è¡Œ seederï¼Œè¯·æš‚æ—¶ç§»é™¤ --no-dev å‚æ•°å¹¶é‡æ–°æ„å»º</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"language-bash\"> composer install --no-interaction --no-plugins --no-scripts --prefer-dist --no-dev -o</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ‹·è´é¡¹ç›®ä»£ç </span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"language-bash\"> . .</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ³¨æ„ï¼šæƒé™é—®é¢˜å°†åœ¨é¦–æ¬¡å¯åŠ¨åé€šè¿‡ exec å‘½ä»¤è§£å†³ï¼Œä»¥ç¡®ä¿ä¸å®¿ä¸»æœºæŒ‚è½½çš„ç›®å½•æƒé™æ­£ç¡®</span></span><br><span class=\"line\"><span class=\"comment\"># RUN chown -R www-data:www-data /var/www/html/storage /var/www/html/bootstrap/cache</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æš´éœ² 9000 ç«¯å£</span></span><br><span class=\"line\"><span class=\"keyword\">EXPOSE</span> <span class=\"number\">9000</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-docker-prod-nginx-default-conf\"><a href=\"#2-docker-prod-nginx-default-conf\" class=\"headerlink\" title=\"2. docker-prod&#x2F;nginx&#x2F;default.conf\"></a><strong>2. docker-prod&#x2F;nginx&#x2F;default.conf</strong></h3><p>æ­¤æ–‡ä»¶å®šä¹‰äº† Nginx çš„é…ç½®è§„åˆ™ï¼Œå®ç°äº† HTTP åˆ° HTTPS çš„è‡ªåŠ¨é‡å®šå‘ï¼Œå¹¶é…ç½®äº† SSL è¯ä¹¦å’Œ PHP-FPM çš„è½¬å‘è§„åˆ™ã€‚</p>\n<figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">listen</span> <span class=\"number\">80</span>;</span><br><span class=\"line\">    <span class=\"attribute\">server_name</span> _; <span class=\"comment\"># åŒ¹é…ä»»ä½•ä¸»æœºå</span></span><br><span class=\"line\">    <span class=\"attribute\">return</span> <span class=\"number\">301</span> https://<span class=\"variable\">$host</span><span class=\"variable\">$request_uri</span>; <span class=\"comment\"># å°†æ‰€æœ‰ HTTP è¯·æ±‚é‡å®šå‘åˆ° HTTPS</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">server</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">listen</span> <span class=\"number\">443</span> ssl;</span><br><span class=\"line\">    <span class=\"attribute\">server_name</span> _;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># SSL è¯ä¹¦é…ç½®</span></span><br><span class=\"line\">    <span class=\"attribute\">ssl_certificate</span> /etc/nginx/certs/lynx.pem;</span><br><span class=\"line\">    <span class=\"attribute\">ssl_certificate_key</span> /etc/nginx/certs/lynx-key.pem;</span><br><span class=\"line\">    <span class=\"attribute\">ssl_protocols</span> TLSv1.<span class=\"number\">2</span> TLSv1.<span class=\"number\">3</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"attribute\">root</span> /var/www/html/public;</span><br><span class=\"line\">    <span class=\"attribute\">index</span> index.php index.html;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"section\">location</span> / &#123;</span><br><span class=\"line\">        <span class=\"attribute\">try_files</span> <span class=\"variable\">$uri</span> <span class=\"variable\">$uri</span>/ /index.php?<span class=\"variable\">$query_string</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"section\">location</span> <span class=\"regexp\">~ \\.php$</span> &#123;</span><br><span class=\"line\">        <span class=\"attribute\">try_files</span> <span class=\"variable\">$uri</span> =<span class=\"number\">404</span>;</span><br><span class=\"line\">        <span class=\"attribute\">fastcgi_split_path_info</span><span class=\"regexp\"> ^(.+\\.php)(/.+)$</span>;</span><br><span class=\"line\">        <span class=\"comment\"># æ³¨æ„è¿™é‡Œçš„ fastcgi_pass æŒ‡å‘çš„æ˜¯ app æœåŠ¡çš„åç§°å’Œç«¯å£</span></span><br><span class=\"line\">        <span class=\"attribute\">fastcgi_pass</span> app:<span class=\"number\">9000</span>;</span><br><span class=\"line\">        <span class=\"attribute\">fastcgi_index</span> index.php;</span><br><span class=\"line\">        <span class=\"attribute\">include</span> fastcgi_params;</span><br><span class=\"line\">        <span class=\"attribute\">fastcgi_param</span> SCRIPT_FILENAME <span class=\"variable\">$document_root</span><span class=\"variable\">$fastcgi_script_name</span>;</span><br><span class=\"line\">        <span class=\"attribute\">fastcgi_param</span> PATH_INFO <span class=\"variable\">$fastcgi_path_info</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"section\">location</span> <span class=\"regexp\">~ /\\.ht</span> &#123;</span><br><span class=\"line\">        <span class=\"attribute\">deny</span> all;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-docker-compose-prod-yml\"><a href=\"#3-docker-compose-prod-yml\" class=\"headerlink\" title=\"3. docker-compose.prod.yml\"></a><strong>3. docker-compose.prod.yml</strong></h3><p>æ­¤æ–‡ä»¶æ˜¯ Docker Compose çš„æœåŠ¡ç¼–æ’é…ç½®ï¼Œå®šä¹‰äº†åº”ç”¨æ‰€éœ€çš„æ‰€æœ‰æœåŠ¡ï¼šPHP åº”ç”¨ã€Nginxã€MySQLã€Redis å’Œé˜Ÿåˆ—å¤„ç†å™¨ã€‚</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"comment\"># 1. Laravel åº”ç”¨æœåŠ¡ (PHP-FPM)</span></span><br><span class=\"line\">  <span class=\"attr\">app:</span></span><br><span class=\"line\">    <span class=\"attr\">build:</span></span><br><span class=\"line\">      <span class=\"attr\">context:</span> <span class=\"string\">.</span></span><br><span class=\"line\">      <span class=\"attr\">dockerfile:</span> <span class=\"string\">docker-prod/app/Dockerfile</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">lynx_app</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">unless-stopped</span></span><br><span class=\"line\">    <span class=\"attr\">working_dir:</span> <span class=\"string\">/var/www/html</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./:/var/www/html</span></span><br><span class=\"line\">      <span class=\"comment\"># ä½¿ç”¨åŒ¿åå·ä¿æŠ¤é•œåƒä¸­å·²æ„å»ºçš„ vendor å’Œ node_modules ç›®å½•ä¸è¢«å®¿ä¸»æœºè¦†ç›–</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">/var/www/html/vendor</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">/var/www/html/node_modules</span></span><br><span class=\"line\">    <span class=\"attr\">networks:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">lynx-network</span></span><br><span class=\"line\">    <span class=\"comment\"># ç¡®ä¿ App åœ¨æ•°æ®åº“å’Œ Redis å¥åº·åæ‰å¯åŠ¨</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on:</span></span><br><span class=\"line\">      <span class=\"attr\">mysql:</span></span><br><span class=\"line\">        <span class=\"attr\">condition:</span> <span class=\"string\">service_healthy</span></span><br><span class=\"line\">      <span class=\"attr\">redis:</span></span><br><span class=\"line\">        <span class=\"attr\">condition:</span> <span class=\"string\">service_healthy</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># 2. Nginx æœåŠ¡</span></span><br><span class=\"line\">  <span class=\"attr\">nginx:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">nginx:alpine</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">lynx_nginx</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">unless-stopped</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">&quot;80:80&quot;</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">&quot;443:443&quot;</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./:/var/www/html</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./docker-prod/nginx/default.conf:/etc/nginx/conf.d/default.conf</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./docker-prod/certs:/etc/nginx/certs</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">app</span></span><br><span class=\"line\">    <span class=\"attr\">networks:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">lynx-network</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># 3. MySQL æ•°æ®åº“æœåŠ¡</span></span><br><span class=\"line\">  <span class=\"attr\">mysql:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">mysql:8.0</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">lynx_mysql</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">unless-stopped</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_DATABASE:</span> <span class=\"string\">$&#123;DB_DATABASE&#125;</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_ROOT_PASSWORD:</span> <span class=\"string\">$&#123;DB_PASSWORD&#125;</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_PASSWORD:</span> <span class=\"string\">$&#123;DB_PASSWORD&#125;</span></span><br><span class=\"line\">      <span class=\"attr\">MYSQL_USER:</span> <span class=\"string\">$&#123;DB_USERNAME&#125;</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">lynx_mysql_data:/var/lib/mysql</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">&quot;3306:3306&quot;</span></span><br><span class=\"line\">    <span class=\"attr\">networks:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">lynx-network</span></span><br><span class=\"line\">    <span class=\"comment\"># ä» Sail å€Ÿé‰´çš„å¥åº·æ£€æŸ¥ï¼Œç¡®ä¿æ•°æ®åº“æœåŠ¡çœŸæ­£å¯ç”¨</span></span><br><span class=\"line\">    <span class=\"attr\">healthcheck:</span></span><br><span class=\"line\">      <span class=\"attr\">test:</span> [<span class=\"string\">&quot;CMD&quot;</span>, <span class=\"string\">&quot;mysqladmin&quot;</span>, <span class=\"string\">&quot;ping&quot;</span>, <span class=\"string\">&quot;-p$&#123;DB_PASSWORD&#125;&quot;</span>]</span><br><span class=\"line\">      <span class=\"attr\">retries:</span> <span class=\"number\">3</span></span><br><span class=\"line\">      <span class=\"attr\">timeout:</span> <span class=\"string\">5s</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># 4. Redis æœåŠ¡</span></span><br><span class=\"line\">  <span class=\"attr\">redis:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">redis:alpine</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">lynx_redis</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">unless-stopped</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">lynx_redis_data:/data</span></span><br><span class=\"line\">    <span class=\"attr\">networks:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">lynx-network</span></span><br><span class=\"line\">    <span class=\"comment\"># ä» Sail å€Ÿé‰´çš„å¥åº·æ£€æŸ¥ï¼Œç¡®ä¿ Redis æœåŠ¡çœŸæ­£å¯ç”¨</span></span><br><span class=\"line\">    <span class=\"attr\">healthcheck:</span></span><br><span class=\"line\">      <span class=\"attr\">test:</span> [<span class=\"string\">&quot;CMD&quot;</span>, <span class=\"string\">&quot;redis-cli&quot;</span>, <span class=\"string\">&quot;ping&quot;</span>]</span><br><span class=\"line\">      <span class=\"attr\">retries:</span> <span class=\"number\">3</span></span><br><span class=\"line\">      <span class=\"attr\">timeout:</span> <span class=\"string\">5s</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\"># 5. Laravel Queue Worker æœåŠ¡</span></span><br><span class=\"line\">  <span class=\"attr\">queue-worker:</span></span><br><span class=\"line\">    <span class=\"attr\">build:</span></span><br><span class=\"line\">      <span class=\"attr\">context:</span> <span class=\"string\">.</span></span><br><span class=\"line\">      <span class=\"attr\">dockerfile:</span> <span class=\"string\">docker-prod/app/Dockerfile</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">lynx_queue_worker</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">unless-stopped</span></span><br><span class=\"line\">    <span class=\"attr\">command:</span> <span class=\"string\">php</span> <span class=\"string\">artisan</span> <span class=\"string\">queue:work</span> <span class=\"string\">--verbose</span> <span class=\"string\">--tries=3</span> <span class=\"string\">--timeout=90</span></span><br><span class=\"line\">    <span class=\"attr\">working_dir:</span> <span class=\"string\">/var/www/html</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./:/var/www/html</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">/var/www/html/vendor</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">/var/www/html/node_modules</span></span><br><span class=\"line\">    <span class=\"attr\">networks:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">lynx-network</span></span><br><span class=\"line\">    <span class=\"comment\"># ç¡®ä¿ Worker ä¹Ÿåœ¨æ•°æ®åº“å’Œ Redis å¥åº·åæ‰å¯åŠ¨</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on:</span></span><br><span class=\"line\">      <span class=\"attr\">mysql:</span></span><br><span class=\"line\">        <span class=\"attr\">condition:</span> <span class=\"string\">service_healthy</span></span><br><span class=\"line\">      <span class=\"attr\">redis:</span></span><br><span class=\"line\">        <span class=\"attr\">condition:</span> <span class=\"string\">service_healthy</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å®šä¹‰ç½‘ç»œ</span></span><br><span class=\"line\"><span class=\"attr\">networks:</span></span><br><span class=\"line\">  <span class=\"attr\">lynx-network:</span></span><br><span class=\"line\">    <span class=\"attr\">driver:</span> <span class=\"string\">bridge</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å®šä¹‰æ•°æ®å· (ç”¨äºæŒä¹…åŒ–)</span></span><br><span class=\"line\"><span class=\"attr\">volumes:</span></span><br><span class=\"line\">  <span class=\"attr\">lynx_mysql_data:</span></span><br><span class=\"line\">    <span class=\"attr\">driver:</span> <span class=\"string\">local</span></span><br><span class=\"line\">  <span class=\"attr\">lynx_redis_data:</span></span><br><span class=\"line\">    <span class=\"attr\">driver:</span> <span class=\"string\">local</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-dockerignore\"><a href=\"#4-dockerignore\" class=\"headerlink\" title=\"4. .dockerignore\"></a><strong>4. .dockerignore</strong></h3><p>æ­¤æ–‡ä»¶ç”¨äºæŒ‡å®šåœ¨æ„å»º Docker é•œåƒæ—¶éœ€è¦å¿½ç•¥çš„æ–‡ä»¶å’Œç›®å½•ï¼Œå¯ä»¥æ˜¾è‘—å‡å°é•œåƒä½“ç§¯å¹¶æé«˜æ„å»ºé€Ÿåº¦ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.git</span><br><span class=\"line\">.github</span><br><span class=\"line\">.gitignore</span><br><span class=\"line\"></span><br><span class=\"line\">.env</span><br><span class=\"line\">.env.example</span><br><span class=\"line\"></span><br><span class=\"line\">/vendor/</span><br><span class=\"line\">/node_modules/</span><br><span class=\"line\"></span><br><span class=\"line\">docker-compose.yml</span><br><span class=\"line\">/docker/</span><br><span class=\"line\"></span><br><span class=\"line\">.idea</span><br><span class=\"line\">.vscode</span><br><span class=\"line\">*.DS_Store</span><br></pre></td></tr></table></figure>\n\n<hr>\n<h2 id=\"å…­ã€æ€»ç»“\"><a href=\"#å…­ã€æ€»ç»“\" class=\"headerlink\" title=\"å…­ã€æ€»ç»“\"></a><strong>å…­ã€æ€»ç»“</strong></h2><p>è‡³æ­¤å°† Laravel é¡¹ç›®é€šè¿‡ Docker è¿›è¡Œç”Ÿäº§ç¯å¢ƒéƒ¨ç½²çš„å®Œæ•´æµç¨‹å·²ä»‹ç»å®Œæ¯•ã€‚è¿™å¥—æ–¹æ¡ˆå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>\n<ul>\n<li>âœ… <strong>å®¹å™¨åŒ–</strong>ï¼šæ‰€æœ‰æœåŠ¡é€šè¿‡ Docker éš”ç¦»è¿è¡Œï¼Œç¯å¢ƒä¸€è‡´æ€§å¼º</li>\n<li>âœ… <strong>æ˜“äºéƒ¨ç½²</strong>ï¼šä¸€é”®æ„å»ºå’Œå¯åŠ¨ï¼Œå‡å°‘ç¯å¢ƒé…ç½®é—®é¢˜</li>\n<li>âœ… <strong>ç”Ÿäº§ä¼˜åŒ–</strong>ï¼šåŒ…å« SSL æ”¯æŒã€å¥åº·æ£€æŸ¥ã€è‡ªåŠ¨é‡å¯ç­‰ç”Ÿäº§çº§ç‰¹æ€§</li>\n<li>âœ… <strong>æ˜“äºç»´æŠ¤</strong>ï¼šæä¾›å®Œæ•´çš„æ—¥å¸¸è¿ç»´å‘½ä»¤ï¼Œä»£ç æ›´æ–°æµç¨‹æ¸…æ™°</li>\n<li>âœ… <strong>å¯æ‰©å±•æ€§</strong>ï¼šåŸºäº Docker Composeï¼Œæ–¹ä¾¿åç»­æ·»åŠ å…¶ä»–æœåŠ¡</li>\n</ul>\n<p>å¦‚æœåœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š</p>\n<ol>\n<li>Docker Desktop æ˜¯å¦æ­£å¸¸è¿è¡Œ</li>\n<li>ç«¯å£ 80ã€443ã€3306 æ˜¯å¦è¢«å ç”¨</li>\n<li>.env æ–‡ä»¶ä¸­çš„é…ç½®æ˜¯å¦æ­£ç¡®</li>\n<li>storage ç›®å½•æƒé™æ˜¯å¦æ­£ç¡®è®¾ç½®</li>\n</ol>\n",
            "tags": [
                "Laravel",
                "Docker",
                "å®¹å™¨åŒ–",
                "éƒ¨ç½²",
                "è¿ç»´"
            ]
        }
    ]
}