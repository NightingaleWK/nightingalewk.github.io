<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://nightingalewk.cn</id>
    <title>雪漫城的风宅 • Posts by &#34;troubleshooting&#34; tag</title>
    <link href="https://nightingalewk.cn" />
    <updated>2026-01-26T02:00:00.000Z</updated>
    <category term="迁移" />
    <category term="电脑维修" />
    <category term="hexo" />
    <category term="主食" />
    <category term="pr" />
    <category term="bilibili" />
    <category term="学习笔记" />
    <category term="热菜" />
    <category term="汤" />
    <category term="梦境" />
    <category term="甜品" />
    <category term="海鲜" />
    <category term="homestead" />
    <category term="代码部署" />
    <category term="oneinstack" />
    <category term="lnmp" />
    <category term="代码更新" />
    <category term="dcat admin" />
    <category term="oh-my-zsh" />
    <category term="debug" />
    <category term="指令" />
    <category term="道歉信" />
    <category term="免密" />
    <category term="vs code" />
    <category term="fileinfo" />
    <category term="laravel sail" />
    <category term="定时任务" />
    <category term="PAC 清单" />
    <category term="gpg" />
    <category term="sshppass" />
    <category term="awk" />
    <category term="net time" />
    <category term="端口查询" />
    <category term="swap" />
    <category term="事件" />
    <category term="表单验证" />
    <category term="wordpress" />
    <category term="blade" />
    <category term="队列" />
    <category term="redis" />
    <category term="特色小吃" />
    <category term="粥" />
    <category term="Cloudreve" />
    <category term="artisan 指令" />
    <category term="Font Awesome" />
    <category term="vite" />
    <category term="故障排除" />
    <category term="linux" />
    <category term="我的世界" />
    <category term="Minecraft" />
    <category term="膝盖中箭之地" />
    <category term="领域" />
    <category term="realms" />
    <category term="公告" />
    <category term="screen" />
    <category term="cursor" />
    <category term="人工智能" />
    <category term="prompt" />
    <category term="打印机" />
    <category term="京瓷" />
    <category term="教程" />
    <category term="Git" />
    <category term="GitHub" />
    <category term="版本控制" />
    <category term="Monorepo" />
    <category term="DevOps" />
    <category term="Docker" />
    <category term="Ubuntu" />
    <category term="安装指南" />
    <category term="阿里云" />
    <category term="镜像源" />
    <category term="Laravel" />
    <category term="容器化" />
    <category term="部署" />
    <category term="运维" />
    <category term="国产化" />
    <category term="信创" />
    <category term="TongHttpServer" />
    <category term="Nginx" />
    <category term="反向代理" />
    <category term="NPM" />
    <category term="HTTPS" />
    <category term="问题排查" />
    <category term="Rule" />
    <category term="Prompt" />
    <category term="gemini" />
    <category term="Sail" />
    <category term="Artisan" />
    <category term="Composer" />
    <category term="WSL2" />
    <category term="Troubleshooting" />
    <category term="Hardware" />
    <category term="Tooling" />
    <entry>
        <id>https://nightingalewk.cn/2026/01/26/86.%20Laravel%20Sail%20%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2%E4%B8%80%E6%8A%8A%E8%BF%87%EF%BC%88%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87%E7%AF%87%EF%BC%89/</id>
        <title>Laravel Sail 开发环境部署一把过（疑难杂症篇）</title>
        <link rel="alternate" href="https://nightingalewk.cn/2026/01/26/86.%20Laravel%20Sail%20%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2%E4%B8%80%E6%8A%8A%E8%BF%87%EF%BC%88%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87%E7%AF%87%EF%BC%89/"/>
        <content type="html">&lt;h2 id=&#34;故障排查概览&#34;&gt;&lt;a href=&#34;#故障排查概览&#34; class=&#34;headerlink&#34; title=&#34;故障排查概览&#34;&gt;&lt;/a&gt;故障排查概览&lt;/h2&gt;&lt;p&gt;本文汇总了在 Windows （WSL2） + Docker 环境下运行 Laravel Sail 时可能遇到的高频问题。我们将从网络、资源、权限与性能四个维度进行分析与解决。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;1-网络连接问题-（Network-Connectivity）&#34;&gt;&lt;a href=&#34;#1-网络连接问题-（Network-Connectivity）&#34; class=&#34;headerlink&#34; title=&#34;1. 网络连接问题 （Network Connectivity）&#34;&gt;&lt;/a&gt;1. 网络连接问题 （Network Connectivity）&lt;/h2&gt;&lt;p&gt;由于 Docker 镜像拉取及 Composer 依赖安装均需访问境外服务器，网络连接稳定性是环境部署的首要前提。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;典型症状&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;curl&lt;/code&gt; 安装脚本连接超时 （&lt;code&gt;Connection refused&lt;/code&gt;）。&lt;/li&gt;
&lt;li&gt;Docker 镜像拉取速度极慢或卡顿。&lt;/li&gt;
&lt;li&gt;Composer 依赖安装失败。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;解决方案&lt;/strong&gt;：&lt;br&gt;建议在宿主机配置能够处理 TUN 流量的代理工具（如 v2rayN 开启 TUN 模式）。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;原理&lt;/strong&gt;：TUN 模式在网络层接管所有流量，能够自动代理 WSL2 及 Docker 容器发出的请求，无需单独配置复杂的 HTTP_PROXY 环境变量或 Docker 镜像源。&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;2-端口冲突-（Port-Conflicts）&#34;&gt;&lt;a href=&#34;#2-端口冲突-（Port-Conflicts）&#34; class=&#34;headerlink&#34; title=&#34;2. 端口冲突 （Port Conflicts）&#34;&gt;&lt;/a&gt;2. 端口冲突 （Port Conflicts）&lt;/h2&gt;&lt;p&gt;Docker 容器尝试绑定的宿主机端口已被占用。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;典型症状&lt;/strong&gt;：&lt;br&gt;&lt;code&gt;sail up&lt;/code&gt; 启动失败，报错：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;Error response from daemon: Ports are not available: listen tcp 0.0.0.0:80: bind: An attempt was made to access a socket in a way forbidden by its access permissions.&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;根本原因&lt;/strong&gt;：&lt;br&gt;Sail 默认绑定端口：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;APP_PORT: 80 （常被 IIS, Apache, 或其他 Web 服务占用）&lt;/li&gt;
&lt;li&gt;MySQL: 3306 （常被本地 MySQL 服务占用）&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;解决方案&lt;/strong&gt;：&lt;br&gt;修改项目根目录 &lt;code&gt;.env&lt;/code&gt; 文件，重映射 Docker 端口：&lt;/p&gt;
&lt;figure class=&#34;highlight ini&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attr&#34;&gt;APP_PORT&lt;/span&gt;=&lt;span class=&#34;number&#34;&gt;8000&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attr&#34;&gt;FORWARD_DB_PORT&lt;/span&gt;=&lt;span class=&#34;number&#34;&gt;33060&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attr&#34;&gt;FORWARD_REDIS_PORT&lt;/span&gt;=&lt;span class=&#34;number&#34;&gt;63790&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;重启服务生效：&lt;code&gt;sail up -d&lt;/code&gt;。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;3-I-O-性能严重下降-（Slow-Performance）&#34;&gt;&lt;a href=&#34;#3-I-O-性能严重下降-（Slow-Performance）&#34; class=&#34;headerlink&#34; title=&#34;3. I&amp;#x2F;O 性能严重下降 （Slow Performance）&#34;&gt;&lt;/a&gt;3. I&amp;#x2F;O 性能严重下降 （Slow Performance）&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;典型症状&lt;/strong&gt;：&lt;br&gt;页面加载延迟极高（&amp;gt;2s），文件读写缓慢。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;根本原因&lt;/strong&gt;：&lt;br&gt;&lt;strong&gt;跨文件系统访问&lt;/strong&gt;。若项目代码存放于 Windows 文件系统（如 &lt;code&gt;/mnt/c/Users/...&lt;/code&gt;），WSL2 需通过 9P 协议进行跨跨系统文件读写，性能损耗巨大。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;最佳实践&lt;/strong&gt;：&lt;br&gt;务必将项目代码存储于 WSL2 原生文件系统中（如 &lt;code&gt;~/code&lt;/code&gt; 或 &lt;code&gt;/var/www&lt;/code&gt;）。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;错误路径&lt;/em&gt;：&lt;code&gt;/mnt/c/Users/Admin/code/project&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;正确路径&lt;/em&gt;：&lt;code&gt;/home/Admin/code/project&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;4-文件权限问题-（Permission-Denied）&#34;&gt;&lt;a href=&#34;#4-文件权限问题-（Permission-Denied）&#34; class=&#34;headerlink&#34; title=&#34;4. 文件权限问题 （Permission Denied）&#34;&gt;&lt;/a&gt;4. 文件权限问题 （Permission Denied）&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;典型症状&lt;/strong&gt;：&lt;br&gt;应用日志无法写入，或缓存文件生成失败。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;根本原因&lt;/strong&gt;：&lt;br&gt;如果在 WSL2 中使用 &lt;code&gt;root&lt;/code&gt; 用户（或者通过 &lt;code&gt;sudo&lt;/code&gt;）执行了生成文件的命令，会导致文件所有者变为 &lt;code&gt;root&lt;/code&gt;，而 Sail 容器内的 &lt;code&gt;sail&lt;/code&gt; 用户（UID 1000）无权写入。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;解决方案&lt;/strong&gt;：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;修复权限&lt;/strong&gt;：使用 Sail 提供的辅助命令重置项目目录权限：&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;sail root-shell &lt;span class=&#34;built_in&#34;&gt;chown&lt;/span&gt; -R sail:sail .&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;预防措施&lt;/strong&gt;：始终通过 &lt;code&gt;sail&lt;/code&gt; 别名执行命令（如 &lt;code&gt;sail npm install&lt;/code&gt;），避免直接使用 &lt;code&gt;sudo&lt;/code&gt;。&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h2 id=&#34;5-外部数据库连接&#34;&gt;&lt;a href=&#34;#5-外部数据库连接&#34; class=&#34;headerlink&#34; title=&#34;5. 外部数据库连接&#34;&gt;&lt;/a&gt;5. 外部数据库连接&lt;/h2&gt;&lt;p&gt;若需使用宿主机的 GUI 工具（如 Navicat, TablePlus）连接容器数据库：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Host&lt;/strong&gt;: &lt;code&gt;localhost&lt;/code&gt; （Docker Desktop 会自动将端口转发至宿主机）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Port&lt;/strong&gt;: &lt;code&gt;3306&lt;/code&gt; （或 &lt;code&gt;.env&lt;/code&gt; 中定义的 &lt;code&gt;FORWARD_DB_PORT&lt;/code&gt;）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;User&lt;/strong&gt;: &lt;code&gt;sail&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Password&lt;/strong&gt;: &lt;code&gt;password&lt;/code&gt; （或 &lt;code&gt;.env&lt;/code&gt; 中定义的 &lt;code&gt;DB_PASSWORD&lt;/code&gt;）&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id=&#34;6-磁盘空间回收-（Disk-Space-Reclamation）&#34;&gt;&lt;a href=&#34;#6-磁盘空间回收-（Disk-Space-Reclamation）&#34; class=&#34;headerlink&#34; title=&#34;6. 磁盘空间回收 （Disk Space Reclamation）&#34;&gt;&lt;/a&gt;6. 磁盘空间回收 （Disk Space Reclamation）&lt;/h2&gt;&lt;p&gt;Docker Desktop 在 Windows 上使用 &lt;code&gt;ext4.vhdx&lt;/code&gt; 虚拟磁盘文件存储数据。该文件具有“动态增长，但不自动缩容”的特性，长期使用可能导致占用大量磁盘空间。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;解决方案：Purge Data&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;若需释放空间，可使用 Docker Desktop 自带的清理功能（注意：此操作将&lt;strong&gt;即时删除所有&lt;/strong&gt;容器、镜像及数据卷）：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;打开 Docker Desktop -&amp;gt; &lt;strong&gt;Troubleshoot&lt;/strong&gt; （右上角甲虫图标）。&lt;/li&gt;
&lt;li&gt;选择 &lt;strong&gt;Clean &amp;#x2F; Purge data&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;勾选 &lt;strong&gt;Disk image&lt;/strong&gt; 并点击 Delete。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;重建环境&lt;/strong&gt;：&lt;br&gt;清理完成后，只需在 WSL2 项目目录中执行两步即可完全恢复环境：&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 1. 重新拉取镜像并启动&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sail up -d&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 2. 重建数据库结构&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sail artisan migrate:fresh --seed&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这也体现了 &lt;strong&gt;Infrastructure as Code&lt;/strong&gt; 的优势：开发环境是可被快速销毁并重建的。&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;结语&#34;&gt;&lt;a href=&#34;#结语&#34; class=&#34;headerlink&#34; title=&#34;结语&#34;&gt;&lt;/a&gt;结语&lt;/h2&gt;&lt;p&gt;至此，&lt;strong&gt;《Laravel Sail 开发环境部署一把过》&lt;/strong&gt; 系列的技术内容告一段落。&lt;br&gt;通过标准化、容器化的开发环境，我们消除了环境差异带来的不确定性。希望本系列能协助 Windows 开发者构建高效、稳定的 Laravel 工作流。&lt;/p&gt;
</content>
        <category term="Laravel" />
        <category term="Sail" />
        <category term="Troubleshooting" />
        <updated>2026-01-26T02:00:00.000Z</updated>
    </entry>
</feed>
